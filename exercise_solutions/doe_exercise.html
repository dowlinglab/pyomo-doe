

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Exercise: Pyomo.DoE &#8212; Pyomo.DoE Workshop and Tutorials</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'exercise_solutions/doe_exercise';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Exercise: ParmEst" href="parmest_exercise.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../Readme.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/PyomoDoE-sm.png" class="logo__image only-light" alt="Pyomo.DoE Workshop and Tutorials - Home"/>
    <script>document.write(`<img src="../_static/PyomoDoE-sm.png" class="logo__image only-dark" alt="Pyomo.DoE Workshop and Tutorials - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../Readme.html">
                    Optimizing Experiments with Pyomo.DoE
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../tclab.html">Modeling Example: TCLab</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/tclab_model.html">TCLab Mathematical Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/numpy_simulation.html">Modeling with Numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/pyomo_simulation.html">Modeling with Pyomo</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/experiment_abstraction.html">Experiment Abstraction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../regression.html">Parameter Estimation</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/parmest.html">Nonlinear Regression with ParmEst</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/parmest_exercise.html">Exercise: ParmEst</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mbdoe.html">Optimal Experiment Design</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/doe_exploratory_analysis.html">Pyomo.DoE: Exploratory Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/doe_optimize.html">Pyomo.DoE: Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/doe_exercise.html">Exercise: Pyomo.DoE</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../exercises.html">Exercise Solutions</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="parmest_exercise.html">Exercise: ParmEst</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Exercise: Pyomo.DoE</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/dowlinglab/pyomo-doe/blob/main/exercise_solutions/doe_exercise.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/dowlinglab/pyomo-doe" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/dowlinglab/pyomo-doe/issues/new?title=Issue%20on%20page%20%2Fexercise_solutions/doe_exercise.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/exercise_solutions/doe_exercise.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Exercise: Pyomo.DoE</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-and-explore-experimental-data-step-test">Load and explore experimental data (step test)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analyze-fim-with-pyomo-doe-at-initial-point-step-test">Analyze FIM with Pyomo.DoE at initial point (step test)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimize-the-next-experiment-a-optimality">Optimize the next experiment (A-optimality)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimize-the-next-experiment-d-optimality">Optimize the next experiment (D-optimality)</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="exercise-pyomo-doe">
<h1>Exercise: Pyomo.DoE<a class="headerlink" href="#exercise-pyomo-doe" title="Permalink to this heading">#</a></h1>
<p>In this notebook, you will use Pyomo.DoE to compute the A- and D-optimal experiments from the TCLab. In our <a class="reference internal" href="../notebooks/doe_optimize.html"><span class="doc std std-doc">previous notebook</span></a>, we used the sine test as a starting point. In this notebook, we will use the step test as the starting point.</p>
<p>Recall, we can computing the next best experiment assuming we already completed one prior experiment. Thus it is important to confirm our optimal experiment design does not change if we change the prior experiment of optimization initial point.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>

<span class="c1"># If running on Google Colab, install Pyomo and Ipopt via IDAES</span>
<span class="n">on_colab</span> <span class="o">=</span> <span class="s2">&quot;google.colab&quot;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span>
<span class="k">if</span> <span class="n">on_colab</span><span class="p">:</span>
    <span class="o">!</span>wget<span class="w"> </span><span class="s2">&quot;https://raw.githubusercontent.com/dowlinglab/pyomo-doe/main/notebooks/tclab_pyomo.py&quot;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">os</span>

    <span class="k">if</span> <span class="s2">&quot;exercise_solutions&quot;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">():</span>
        <span class="c1"># Add the &quot;notebooks&quot; folder to the path</span>
        <span class="c1"># This is needed for running the solutions from a separate folder</span>
        <span class="c1"># You only need this if you run locally</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;../notebooks&#39;</span><span class="p">)</span>

<span class="c1"># import TCLab model, simulation, and data analysis functions</span>
<span class="kn">from</span> <span class="nn">tclab_pyomo</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">TC_Lab_data</span><span class="p">,</span>
    <span class="n">TC_Lab_experiment</span><span class="p">,</span>
    <span class="n">extract_results</span><span class="p">,</span>
    <span class="n">extract_plot_results</span><span class="p">,</span>
    <span class="n">results_summary</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># set default number of states in the TCLab model</span>
<span class="n">number_tclab_states</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<section id="load-and-explore-experimental-data-step-test">
<h2>Load and explore experimental data (step test)<a class="headerlink" href="#load-and-explore-experimental-data-step-test" title="Permalink to this heading">#</a></h2>
<p>We will load the step test experimental data, similar to our previous notebooks.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="k">if</span> <span class="n">on_colab</span><span class="p">:</span>
    <span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/dowlinglab/pyomo-doe/main/data/tclab_step_test.csv&quot;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">file</span> <span class="o">=</span> <span class="s1">&#39;../data/tclab_step_test.csv&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
      <th>T1</th>
      <th>T2</th>
      <th>Q1</th>
      <th>Q2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.00</td>
      <td>22.84</td>
      <td>22.84</td>
      <td>50.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.00</td>
      <td>22.84</td>
      <td>22.84</td>
      <td>50.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.01</td>
      <td>23.16</td>
      <td>22.84</td>
      <td>50.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.02</td>
      <td>22.84</td>
      <td>22.84</td>
      <td>50.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.01</td>
      <td>22.84</td>
      <td>22.84</td>
      <td>50.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="s1">&#39;T2&#39;</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Temperature (°C)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1ee9dd18615153b5a6944ec972e3588406e8b3544ed07c9f3984189658849528.png" src="../_images/1ee9dd18615153b5a6944ec972e3588406e8b3544ed07c9f3984189658849528.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Heater Power (%)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a8d901d5fa16a02593dd6bf76153bea54dc8d2a97d4e1a424731a4a6c42fb6bb.png" src="../_images/a8d901d5fa16a02593dd6bf76153bea54dc8d2a97d4e1a424731a4a6c42fb6bb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Here, we will induce a step size of 10 seconds, as to not give too many </span>
<span class="c1"># degrees of freedom for experimental design.</span>
<span class="n">skip</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># Create the data object considering the new control points every 6 seconds</span>
<span class="n">tc_data</span> <span class="o">=</span> <span class="n">TC_Lab_data</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Sine Wave Test for Heater 1&quot;</span><span class="p">,</span>
    <span class="n">time</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[::</span><span class="n">skip</span><span class="p">],</span>
    <span class="n">T1</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;T1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[::</span><span class="n">skip</span><span class="p">],</span>
    <span class="n">u1</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Q1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[::</span><span class="n">skip</span><span class="p">],</span>
    <span class="n">P1</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
    <span class="n">TS1_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">T2</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;T2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[::</span><span class="n">skip</span><span class="p">],</span>
    <span class="n">u2</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Q2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[::</span><span class="n">skip</span><span class="p">],</span>
    <span class="n">P2</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
    <span class="n">TS2_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">Tamb</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;T1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="analyze-fim-with-pyomo-doe-at-initial-point-step-test">
<h2>Analyze FIM with Pyomo.DoE at initial point (step test)<a class="headerlink" href="#analyze-fim-with-pyomo-doe-at-initial-point-step-test" title="Permalink to this heading">#</a></h2>
<p>To get started, compute and analyze the FIM of the step test experiment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load Pyomo.DoE class</span>
<span class="kn">from</span> <span class="nn">pyomo.contrib.doe</span> <span class="kn">import</span> <span class="n">DesignOfExperiments</span>

<span class="kn">from</span> <span class="nn">pyomo.environ</span> <span class="kn">import</span> <span class="n">SolverFactory</span>

<span class="c1"># Copied from previous notebook</span>
<span class="n">theta_values</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Ua&#39;</span><span class="p">:</span> <span class="mf">0.0417051733576387</span><span class="p">,</span>
    <span class="s1">&#39;Ub&#39;</span><span class="p">:</span> <span class="mf">0.009440714239773074</span><span class="p">,</span>
    <span class="s1">&#39;inv_CpH&#39;</span><span class="p">:</span> <span class="mf">0.1659093525658045</span><span class="p">,</span>
    <span class="s1">&#39;inv_CpS&#39;</span><span class="p">:</span> <span class="mf">5.8357556063605465</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create experiment object for design of experiments</span>
<span class="n">doe_experiment</span> <span class="o">=</span> <span class="n">TC_Lab_experiment</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">tc_data</span><span class="p">,</span> <span class="n">theta_initial</span><span class="o">=</span><span class="n">theta_values</span><span class="p">,</span> <span class="n">number_of_states</span><span class="o">=</span><span class="n">number_tclab_states</span><span class="p">)</span>

<span class="c1"># Create the design of experiments object using our experiment instance from above</span>
<span class="n">TC_Lab_DoE</span> <span class="o">=</span> <span class="n">DesignOfExperiments</span><span class="p">(</span><span class="n">experiment</span><span class="o">=</span><span class="n">doe_experiment</span><span class="p">,</span> 
                                 <span class="n">step</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
                                 <span class="n">scale_constant_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                 <span class="n">scale_nominal_param_value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                 <span class="n">tee</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>

<span class="n">FIM</span> <span class="o">=</span> <span class="n">TC_Lab_DoE</span><span class="o">.</span><span class="n">compute_FIM</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sequential&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Call our custom function to summarize the results</span>
<span class="c1"># and compute the eigendecomposition of the FIM</span>

<span class="n">results_summary</span><span class="p">(</span><span class="n">FIM</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>======Results Summary======
Four design criteria log10() value:
A-optimality: 5.479278059341219
D-optimality: 8.809234454721581
E-optimality: -3.1126039391788907
Modified E-optimality: 8.570445782387669

FIM:
 [[280055.18540639  -3320.41889892 -42508.35322699  -4661.44955393]
 [ -3320.41889892    510.68043306   2729.38521901    584.8450854 ]
 [-42508.35322699   2729.38521901  20251.11718816   3322.1354697 ]
 [ -4661.44955393    584.8450854    3322.1354697     676.59046558]]

eigenvalues:
 [2.86973532e+05 1.43167335e+04 2.03307130e+02 7.71606826e-04]

eigenvectors:
 [[-9.87239625e-01  1.58273951e-01 -1.75293670e-02  1.33926737e-06]
 [ 1.29823029e-02  1.58928598e-01  7.03772484e-01 -6.92298672e-01]
 [ 1.57695528e-01  9.56659449e-01 -2.43536246e-01 -2.49983328e-02]
 [ 1.79304963e-02  1.85724948e-01  6.67148491e-01  7.21177948e-01]]
</pre></div>
</div>
</div>
</div>
<p><strong>Discussion:</strong> How does this FIM compare to the sine test experiment we <a class="reference internal" href="../notebooks/doe_exploratory_analysis.html"><span class="doc std std-doc">previously analyzed</span></a>?</p>
</section>
<section id="optimize-the-next-experiment-a-optimality">
<h2>Optimize the next experiment (A-optimality)<a class="headerlink" href="#optimize-the-next-experiment-a-optimality" title="Permalink to this heading">#</a></h2>
<p>Now we are ready to compute the A-optimal next best experiment. Why are we starting with A-optimality? It runs faster so it is better for debugging syntax.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create experiment object for design of experiments</span>
<span class="n">doe_experiment</span> <span class="o">=</span> <span class="n">TC_Lab_experiment</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">tc_data</span><span class="p">,</span> <span class="n">theta_initial</span><span class="o">=</span><span class="n">theta_values</span><span class="p">,</span> <span class="n">number_of_states</span><span class="o">=</span><span class="n">number_tclab_states</span><span class="p">)</span>

<span class="c1"># Create the design of experiments object using our experiment instance from above</span>
<span class="n">TC_Lab_DoE_A</span> <span class="o">=</span> <span class="n">DesignOfExperiments</span><span class="p">(</span><span class="n">experiment</span><span class="o">=</span><span class="n">doe_experiment</span><span class="p">,</span> 
                                 <span class="n">step</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
                                 <span class="n">scale_constant_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                 <span class="n">scale_nominal_param_value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                 <span class="n">objective_option</span><span class="o">=</span><span class="s2">&quot;trace&quot;</span><span class="p">,</span>  <span class="c1"># Now we specify a type of objective, A-opt = &quot;trace&quot;</span>
                                 <span class="n">prior_FIM</span><span class="o">=</span><span class="n">FIM</span><span class="p">,</span>  <span class="c1"># We use the prior information from the same existing experiment as in the D-optimal case!</span>
                                 <span class="n">tee</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>

<span class="n">TC_Lab_DoE_A</span><span class="o">.</span><span class="n">run_doe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1080
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      362
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      180
                     variables with only upper bounds:        0
Total number of equality constraints.................:      362
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 2.65e-01 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1  0.0000000e+00 1.78e-15 5.10e-04  -1.0 5.18e-01    -  9.79e-01 1.00e+00h  1

Number of Iterations....: 1

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   0.0000000000000000e+00    0.0000000000000000e+00
Constraint violation....:   1.7763568394002505e-15    1.7763568394002505e-15
Complementarity.........:   0.0000000000000000e+00    0.0000000000000000e+00
Overall NLP error.......:   1.7763568394002505e-15    1.7763568394002505e-15


Number of objective function evaluations             = 2
Number of objective gradient evaluations             = 2
Number of equality constraint evaluations            = 2
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 2
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 1
Total CPU secs in IPOPT (w/o function evaluations)   =      0.000
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1171
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      453
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      271
                     variables with only upper bounds:        0
Total number of equality constraints.................:      362
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 2.65e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (11025)
   1  0.0000000e+00 1.78e-15 1.94e-04  -1.0 2.57e-01    -  9.84e-01 1.00e+00h  1
   2  0.0000000e+00 1.78e-15 7.29e-17  -1.0 2.13e+00    -  1.00e+00 1.00e+00f  1
   3  0.0000000e+00 1.78e-15 7.05e-18  -2.5 3.48e-01    -  1.00e+00 1.00e+00f  1
   4  0.0000000e+00 1.78e-15 1.97e-19  -3.8 6.45e-01    -  1.00e+00 1.00e+00f  1
   5  0.0000000e+00 1.80e-15 9.69e-21  -5.7 1.39e-01    -  1.00e+00 1.00e+00h  1
   6  0.0000000e+00 1.39e-15 1.26e-22  -8.6 1.52e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 6

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   1.2578315189634477e-22    1.2578315189634477e-22
Constraint violation....:   1.3877787807814457e-15    1.3877787807814457e-15
Complementarity.........:   3.2874888828090638e-09    3.2874888828090638e-09
Overall NLP error.......:   3.2874888828090638e-09    3.2874888828090638e-09


Number of objective function evaluations             = 7
Number of objective gradient evaluations             = 7
Number of equality constraint evaluations            = 7
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 7
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 6
Total CPU secs in IPOPT (w/o function evaluations)   =      0.006
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1171
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      453
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      271
                     variables with only upper bounds:        0
Total number of equality constraints.................:      362
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 2.65e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (11025)
   1  0.0000000e+00 1.78e-15 2.22e-04  -1.0 3.32e-01    -  9.85e-01 1.00e+00h  1
   2  0.0000000e+00 1.78e-15 7.81e-17  -1.0 1.86e+00    -  1.00e+00 1.00e+00f  1
   3  0.0000000e+00 1.78e-15 7.70e-18  -2.5 3.54e-01    -  1.00e+00 1.00e+00f  1
   4  0.0000000e+00 1.78e-15 1.83e-19  -3.8 6.45e-01    -  1.00e+00 1.00e+00f  1
   5  0.0000000e+00 1.78e-15 1.26e-20  -5.7 1.41e-01    -  1.00e+00 1.00e+00h  1
   6  0.0000000e+00 1.78e-15 1.09e-22  -8.6 1.54e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 6

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   1.0867085297415401e-22    1.0867085297415401e-22
Constraint violation....:   1.7763568394002505e-15    1.7763568394002505e-15
Complementarity.........:   3.3107750038258920e-09    3.3107750038258920e-09
Overall NLP error.......:   3.3107750038258920e-09    3.3107750038258920e-09


Number of objective function evaluations             = 7
Number of objective gradient evaluations             = 7
Number of equality constraint evaluations            = 7
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 7
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 6
Total CPU secs in IPOPT (w/o function evaluations)   =      0.000
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1171
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      453
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      271
                     variables with only upper bounds:        0
Total number of equality constraints.................:      362
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 1.80e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (11025)
   1  0.0000000e+00 1.78e-15 1.99e-05  -1.0 3.56e-02    -  9.91e-01 1.00e+00h  1
   2  0.0000000e+00 1.78e-15 6.07e-18  -1.7 6.32e-01    -  1.00e+00 1.00e+00f  1
   3  0.0000000e+00 1.78e-15 1.86e-18  -3.8 1.03e-01    -  1.00e+00 1.00e+00f  1
   4  0.0000000e+00 1.78e-15 1.26e-20  -5.7 1.68e-01    -  1.00e+00 1.00e+00h  1
   5  0.0000000e+00 1.78e-15 1.29e-22  -8.6 1.83e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 5

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   1.2862658525199580e-22    1.2862658525199580e-22
Constraint violation....:   1.7763568394002505e-15    1.7763568394002505e-15
Complementarity.........:   3.4533556448167006e-09    3.4533556448167006e-09
Overall NLP error.......:   3.4533556448167006e-09    3.4533556448167006e-09


Number of objective function evaluations             = 6
Number of objective gradient evaluations             = 6
Number of equality constraint evaluations            = 6
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 6
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 5
Total CPU secs in IPOPT (w/o function evaluations)   =      0.000
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1171
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      453
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      271
                     variables with only upper bounds:        0
Total number of equality constraints.................:      362
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 1.80e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (11025)
   1  0.0000000e+00 1.78e-15 2.58e-05  -1.0 3.52e-02    -  9.91e-01 1.00e+00h  1
   2  0.0000000e+00 1.78e-15 7.81e-18  -1.7 6.32e-01    -  1.00e+00 1.00e+00f  1
   3  0.0000000e+00 1.78e-15 1.55e-18  -3.8 1.03e-01    -  1.00e+00 1.00e+00f  1
   4  0.0000000e+00 1.78e-15 1.68e-20  -5.7 1.68e-01    -  1.00e+00 1.00e+00h  1
   5  0.0000000e+00 1.78e-15 1.57e-22  -8.6 1.83e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 5

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   1.5695752123193700e-22    1.5695752123193700e-22
Constraint violation....:   1.7763568394002505e-15    1.7763568394002505e-15
Complementarity.........:   3.4533025836104998e-09    3.4533025836104998e-09
Overall NLP error.......:   3.4533025836104998e-09    3.4533025836104998e-09


Number of objective function evaluations             = 6
Number of objective gradient evaluations             = 6
Number of equality constraint evaluations            = 6
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 6
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 5
Total CPU secs in IPOPT (w/o function evaluations)   =      0.000
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1171
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      453
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      271
                     variables with only upper bounds:        0
Total number of equality constraints.................:      362
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 2.65e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (11025)
   1  0.0000000e+00 1.78e-15 5.36e-05  -1.0 1.27e-01    -  9.89e-01 1.00e+00h  1
   2  0.0000000e+00 1.78e-15 2.69e-17  -1.7 5.40e-01    -  1.00e+00 1.00e+00f  1
   3  0.0000000e+00 1.78e-15 1.69e-18  -3.8 1.04e-01    -  1.00e+00 1.00e+00f  1
   4  0.0000000e+00 1.78e-15 1.24e-20  -5.7 1.70e-01    -  1.00e+00 1.00e+00h  1
   5  0.0000000e+00 1.78e-15 1.18e-22  -8.6 1.84e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 5

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   1.1808003244194470e-22    1.1808003244194470e-22
Constraint violation....:   1.7763568394002505e-15    1.7763568394002505e-15
Complementarity.........:   3.4600225074837807e-09    3.4600225074837807e-09
Overall NLP error.......:   3.4600225074837807e-09    3.4600225074837807e-09


Number of objective function evaluations             = 6
Number of objective gradient evaluations             = 6
Number of equality constraint evaluations            = 6
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 6
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 5
Total CPU secs in IPOPT (w/o function evaluations)   =      0.004
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1171
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      453
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      271
                     variables with only upper bounds:        0
Total number of equality constraints.................:      362
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 2.65e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (11025)
   1  0.0000000e+00 1.78e-15 4.90e-05  -1.0 1.18e-01    -  9.90e-01 1.00e+00h  1
   2  0.0000000e+00 1.78e-15 2.30e-17  -1.7 5.56e-01    -  1.00e+00 1.00e+00f  1
   3  0.0000000e+00 1.78e-15 1.53e-18  -3.8 1.04e-01    -  1.00e+00 1.00e+00f  1
   4  0.0000000e+00 1.78e-15 1.39e-20  -5.7 1.70e-01    -  1.00e+00 1.00e+00h  1
   5  0.0000000e+00 1.78e-15 1.21e-22  -8.6 1.84e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 5

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   1.2097516458588030e-22    1.2097516458588030e-22
Constraint violation....:   1.7763568394002505e-15    1.7763568394002505e-15
Complementarity.........:   3.4581298725181036e-09    3.4581298725181036e-09
Overall NLP error.......:   3.4581298725181036e-09    3.4581298725181036e-09


Number of objective function evaluations             = 6
Number of objective gradient evaluations             = 6
Number of equality constraint evaluations            = 6
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 6
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 5
Total CPU secs in IPOPT (w/o function evaluations)   =      0.005
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1171
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      453
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      271
                     variables with only upper bounds:        0
Total number of equality constraints.................:      362
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 1.80e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (11025)
   1  0.0000000e+00 1.78e-15 1.99e-05  -1.0 3.64e-02    -  9.91e-01 1.00e+00h  1
   2  0.0000000e+00 1.86e-15 7.81e-18  -1.7 6.31e-01    -  1.00e+00 1.00e+00f  1
   3  0.0000000e+00 1.95e-15 1.46e-18  -3.8 1.03e-01    -  1.00e+00 1.00e+00f  1
   4  0.0000000e+00 1.78e-15 1.18e-20  -5.7 1.68e-01    -  1.00e+00 1.00e+00h  1
   5  0.0000000e+00 1.78e-15 1.57e-22  -8.6 1.83e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 5

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   1.5654393092566049e-22    1.5654393092566049e-22
Constraint violation....:   1.7763568394002505e-15    1.7763568394002505e-15
Complementarity.........:   3.4534443694469787e-09    3.4534443694469787e-09
Overall NLP error.......:   3.4534443694469787e-09    3.4534443694469787e-09


Number of objective function evaluations             = 6
Number of objective gradient evaluations             = 6
Number of equality constraint evaluations            = 6
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 6
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 5
Total CPU secs in IPOPT (w/o function evaluations)   =      0.000
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1171
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      453
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      271
                     variables with only upper bounds:        0
Total number of equality constraints.................:      362
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 1.80e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (11025)
   1  0.0000000e+00 1.78e-15 2.58e-05  -1.0 3.47e-02    -  9.91e-01 1.00e+00h  1
   2  0.0000000e+00 2.66e-15 5.20e-18  -1.7 6.33e-01    -  1.00e+00 1.00e+00f  1
   3  0.0000000e+00 1.78e-15 1.23e-18  -3.8 1.03e-01    -  1.00e+00 1.00e+00f  1
   4  0.0000000e+00 1.78e-15 1.34e-20  -5.7 1.68e-01    -  1.00e+00 1.00e+00h  1
   5  0.0000000e+00 1.78e-15 1.03e-22  -8.6 1.83e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 5

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   1.0288058868628282e-22    1.0288058868628282e-22
Constraint violation....:   1.7763568394002505e-15    1.7763568394002505e-15
Complementarity.........:   3.4532364509691435e-09    3.4532364509691435e-09
Overall NLP error.......:   3.4532364509691435e-09    3.4532364509691435e-09


Number of objective function evaluations             = 6
Number of objective gradient evaluations             = 6
Number of equality constraint evaluations            = 6
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 6
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 5
Total CPU secs in IPOPT (w/o function evaluations)   =      0.000
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:    12464
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:      910

Total number of variables............................:     3907
                     variables with only lower bounds:        0
                variables with lower and upper bounds:     2077
                     variables with only upper bounds:        0
Total number of equality constraints.................:     3907
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 2.78e+01 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (207913)
   1  0.0000000e+00 2.54e+05 5.60e-03  -1.0 3.56e+01    -  9.35e-01 1.00e+00h  1
   2  0.0000000e+00 1.16e-10 4.65e-12  -1.0 2.54e+05    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 2

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   0.0000000000000000e+00    0.0000000000000000e+00
Constraint violation....:   1.1641532182693481e-10    1.1641532182693481e-10
Complementarity.........:   0.0000000000000000e+00    0.0000000000000000e+00
Overall NLP error.......:   1.1641532182693481e-10    1.1641532182693481e-10


Number of objective function evaluations             = 3
Number of objective gradient evaluations             = 3
Number of equality constraint evaluations            = 3
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 3
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 2
Total CPU secs in IPOPT (w/o function evaluations)   =      0.055
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:    13197
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:      911

Reallocating memory for MA57: lfact (249688)
Total number of variables............................:     3999
                     variables with only lower bounds:        1
                variables with lower and upper bounds:     2168
                     variables with only upper bounds:        0
Total number of equality constraints.................:     3908
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0 -5.4792838e+00 2.72e+05 1.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (262838)
   1 -5.5205848e+00 5.08e+04 1.26e+01  -1.0 2.25e+05    -  6.06e-01 1.00e+00h  1
   2 -5.5604000e+00 1.72e+03 1.70e+00  -1.0 3.18e+04    -  9.03e-01 1.00e+00h  1
   3 -5.5635707e+00 2.91e+00 2.92e-02  -1.0 2.66e+03    -  9.83e-01 1.00e+00h  1
   4 -5.6121304e+00 8.19e+03 9.93e-04  -1.0 4.33e+04    -  8.92e-01 1.00e+00f  1
   5 -5.6754752e+00 6.78e+03 1.73e-04  -1.0 6.43e+04    -  1.00e+00 1.00e+00h  1
   6 -5.6790932e+00 2.37e+01 1.00e-06  -1.0 3.96e+03    -  1.00e+00 1.00e+00h  1
   7 -5.6791515e+00 1.82e-03 1.00e-06  -1.0 6.41e+01    -  1.00e+00 1.00e+00h  1
   8 -5.6796924e+00 4.74e-01 2.89e-07  -2.5 5.95e+02    -  1.00e+00 1.00e+00h  1
   9 -5.6983805e+00 5.90e+02 5.33e-07  -2.5 2.10e+04    -  1.00e+00 1.00e+00h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  10 -5.6988637e+00 1.41e-02 2.83e-08  -2.5 5.56e+02    -  1.00e+00 1.00e+00h  1
  11 -5.7181112e+00 6.07e+02 1.16e-06  -3.8 2.27e+04    -  9.83e-01 1.00e+00h  1
  12 -5.9507673e+00 6.34e+04 1.80e-03  -3.8 3.77e+05    -  1.00e+00 1.00e+00H  1
  13 -5.9210919e+00 4.53e+03 1.33e-03  -3.8 5.90e+04    -  1.00e+00 1.00e+00h  1
  14 -5.9211003e+00 3.50e+03 3.29e-02  -3.8 1.09e+02  -4.0 9.25e-01 2.41e-01h  1
  15 -5.9121033e+00 2.55e+02 6.73e-03  -3.8 1.90e+04    -  1.00e+00 1.00e+00h  1
  16 -5.9283851e+00 1.30e+03 3.46e-03  -3.8 6.43e+04    -  1.00e+00 4.85e-01h  2
  17 -5.9364352e+00 2.17e+02 1.31e-06  -3.8 1.59e+04    -  1.00e+00 1.00e+00h  1
  18 -5.9365759e+00 3.94e-01 1.88e-08  -3.8 2.80e+02    -  1.00e+00 1.00e+00h  1
  19 -5.9365726e+00 1.32e-04 1.50e-09  -3.8 6.91e+00    -  1.00e+00 1.00e+00h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  20 -6.0353683e+00 1.98e+04 1.01e-05  -5.7 2.21e+05    -  7.96e-01 1.00e+00f  1
  21 -6.0734174e+00 8.35e+03 1.03e-05  -5.7 1.37e+05    -  5.97e-01 7.24e-01h  1
  22 -6.0804794e+00 4.32e+03 7.64e-06  -5.7 3.92e+04    -  5.60e-01 4.95e-01h  1
  23 -6.0822916e+00 2.97e+03 2.55e-05  -5.7 1.59e+04    -  5.48e-01 3.17e-01h  1
  24 -6.0833848e+00 1.98e+03 5.06e-05  -5.7 9.15e+03    -  7.71e-01 3.33e-01h  1
  25 -6.0833847e+00 1.63e+03 3.52e-03  -5.7 9.56e+00  -4.5 3.08e-03 1.78e-01h  1
  26 -6.0842810e+00 5.47e+02 1.04e-03  -5.7 3.76e+03    -  2.47e-01 6.65e-01h  1
  27 -6.0848595e+00 1.10e+02 2.07e-04  -5.7 2.02e+03    -  8.15e-01 8.01e-01h  1
  28 -6.0851552e+00 2.12e+01 4.02e-05  -5.7 1.26e+03    -  1.00e+00 8.17e-01h  1
  29 -6.0851552e+00 3.05e+00 1.93e-04  -5.7 1.23e+00  -5.0 9.06e-01 8.58e-01h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  30 -6.0852583e+00 5.00e+00 1.29e-03  -5.7 8.81e+02    -  1.00e+00 6.24e-01h  1
  31 -6.0853118e+00 2.33e+01 5.11e-05  -5.7 1.25e+03    -  1.00e+00 9.60e-01h  1
  32 -6.0853456e+00 3.26e+01 9.11e-06  -5.7 1.19e+03    -  6.04e-01 1.00e+00h  1
  33 -6.0853679e+00 1.69e+00 7.66e-11  -5.7 2.18e+02    -  1.00e+00 1.00e+00h  1
  34 -6.0853866e+00 1.16e+00 9.63e-11  -5.7 2.46e+02    -  1.00e+00 1.00e+00h  1
  35 -6.0853851e+00 3.15e-02 1.84e-11  -5.7 3.67e+01    -  1.00e+00 1.00e+00h  1
  36 -6.0853851e+00 9.59e-07 1.84e-11  -5.7 2.11e-01    -  1.00e+00 1.00e+00h  1
  37 -6.0857880e+00 1.26e+01 9.32e-06  -8.6 2.75e+03    -  5.49e-01 4.11e-01h  1
  38 -6.0857883e+00 2.01e-02 2.57e-04  -8.6 2.94e+00  -5.4 1.83e-02 1.00e+00h  1
  39 -6.0857896e+00 2.00e-02 2.78e-04  -8.6 1.11e+03    -  7.81e-01 3.27e-03h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  40 -6.0860764e+00 3.60e-01 6.18e-05  -8.6 1.03e+03    -  9.44e-01 7.81e-01f  1
  41 -6.0861453e+00 1.37e+00 1.33e-05  -8.6 2.47e+02    -  5.63e-01 7.84e-01h  1
  42 -6.0861494e+00 1.47e+00 4.46e-05  -8.6 1.97e+03    -  1.00e+00 3.30e-02h  1
  43 -6.0861639e+00 4.58e-02 7.89e-06  -8.6 4.20e+01    -  5.07e-01 9.69e-01h  1
  44 -6.0861639e+00 7.87e-08 1.14e-07  -8.6 9.27e-02  -5.9 1.00e+00 1.00e+00h  1
  45 -6.0861641e+00 6.45e-05 1.14e-05  -8.6 5.69e+00    -  3.99e-01 2.10e-01h  1
  46 -6.0861641e+00 3.96e-07 4.75e-08  -8.6 1.15e-01  -6.4 1.00e+00 1.00e+00f  1
  47 -6.0861646e+00 3.14e-03 2.77e-05  -8.6 6.97e+00    -  2.97e-01 1.00e+00h  1
  48 -6.0861646e+00 7.42e-07 1.26e-08  -8.6 9.22e-02  -6.9 1.00e+00 1.00e+00h  1
  49 -6.0861688e+00 2.02e+00 1.01e-05  -8.6 1.73e+02    -  5.17e-02 1.00e+00h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  50 -6.0861700e+00 3.44e-06 1.47e-07  -8.6 3.22e+00  -7.3 1.00e+00 1.00e+00h  1
  51 -6.0861703e+00 6.23e-05 1.57e-08  -8.6 1.03e+00  -7.8 1.00e+00 1.00e+00h  1
  52 -6.0861704e+00 7.09e-04 1.66e-08  -8.6 3.26e+00  -8.3 1.00e+00 1.00e+00h  1
  53 -6.0861708e+00 6.63e-03 1.69e-08  -8.6 9.95e+00  -8.8 1.00e+00 1.00e+00h  1
  54 -6.0861722e+00 6.81e-02 1.80e-08  -8.6 3.19e+01  -9.2 1.00e+00 1.00e+00h  1
  55 -6.0861763e+00 5.48e-01 1.84e-07  -8.6 1.18e+02  -9.7 1.00e+00 7.54e-01h  1
  56 -6.0861745e+00 1.06e-01 2.77e-08  -8.6 3.98e+01    -  1.00e+00 1.00e+00h  1
  57 -6.0861766e+00 1.14e-01 2.04e-08  -8.6 4.28e+01    -  1.00e+00 9.32e-01h  1
  58 -6.0861767e+00 2.16e-07 4.66e-06  -8.6 2.09e-01    -  7.21e-01 1.00e+00h  1
  59 -6.0861767e+00 1.82e-07 5.49e-08  -8.6 2.69e-02    -  9.95e-01 1.00e+00h  1
Reallocating memory for MA57: lfact (287702)
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  60 -6.0861767e+00 2.61e-08 2.51e-14  -8.6 9.61e-03    -  1.00e+00 1.00e+00h  1
  61 -6.0861767e+00 9.17e-10 2.51e-14  -8.6 1.77e-03    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 61

                                   (scaled)                 (unscaled)
Objective...............:  -6.0861766779793482e+00   -6.0861766779793482e+00
Dual infeasibility......:   2.5059035581162194e-14    2.5059035581162194e-14
Constraint violation....:   9.0273285995244442e-10    9.1677065938711166e-10
Complementarity.........:   2.5190955416012936e-09    2.5190955416012936e-09
Overall NLP error.......:   2.5190955416012936e-09    2.5190955416012936e-09


Number of objective function evaluations             = 66
Number of objective gradient evaluations             = 62
Number of equality constraint evaluations            = 66
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 62
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 61
Total CPU secs in IPOPT (w/o function evaluations)   =      1.648
Total CPU secs in NLP function evaluations           =      0.024

EXIT: Optimal Solution Found.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract and plot the results using our custom function</span>
<span class="c1">### BEGIN SOLUTION</span>
<span class="n">aopt_pyomo_doe_results</span> <span class="o">=</span> <span class="n">extract_plot_results</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">TC_Lab_DoE_A</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">scenario_blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="c1">### END SOLUTION</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f589f2204a0e27decb1bd392434286489cf5de693fc04ce13f1e19af82b899f6.png" src="../_images/f589f2204a0e27decb1bd392434286489cf5de693fc04ce13f1e19af82b899f6.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0421 Watts/degC
Ub = 0.0094 Watts/degC
CpH = 6.0274 Joules/degC
CpS = 0.1714 Joules/degC
 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the FIM at the optimal solution</span>
<span class="c1">### BEGIN SOLUTION</span>
<span class="n">results_summary</span><span class="p">(</span><span class="n">TC_Lab_DoE_A</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;FIM&#39;</span><span class="p">])</span>
<span class="c1">### END SOLUTION</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>======Results Summary======
Four design criteria log10() value:
A-optimality: 6.086176677979348
D-optimality: 12.10216308145059
E-optimality: -1.8430490851995411
Modified E-optimality: 7.903999360724161

FIM:
 [[1128333.9541418809, -10344.660945130825, -152904.22848832433, -15046.559242758245], [-10344.660945130825, 2401.6027739254746, 11862.047413143466, 2711.232065796269], [-152904.22848832433, 11862.047413143466, 85659.76582339974, 14284.600287465535], [-15046.559242758245, 2711.232065796269, 14284.600287465535, 3090.281642352252]]

eigenvalues:
 [1.15066864e+06 6.76851576e+04 1.13179676e+03 1.43532720e-02]

eigenvectors:
 [[-9.89644319e-01  1.42450825e-01 -1.76602664e-02  9.29188738e-06]
 [ 1.04215507e-02  1.59402422e-01  7.01400722e-01 -6.94636082e-01]
 [ 1.42398295e-01  9.59088274e-01 -2.43539221e-01 -2.36866202e-02]
 [ 1.47729345e-02  1.85602567e-01  6.69637059e-01  7.18971249e-01]]
</pre></div>
</div>
</div>
</div>
<p><strong>Discussion:</strong> How do these compare to our <a class="reference internal" href="../notebooks/doe_optimize.html"><span class="doc std std-doc">previous A-optimal results</span></a> considering the sine test as the prior experiment?</p>
</section>
<section id="optimize-the-next-experiment-d-optimality">
<h2>Optimize the next experiment (D-optimality)<a class="headerlink" href="#optimize-the-next-experiment-d-optimality" title="Permalink to this heading">#</a></h2>
<p>Finally, we are ready to solve the D-optimality problem. This may take 2 minutes to run.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create experiment object for design of experiments</span>
<span class="n">doe_experiment</span> <span class="o">=</span> <span class="n">TC_Lab_experiment</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">tc_data</span><span class="p">,</span> <span class="n">theta_initial</span><span class="o">=</span><span class="n">theta_values</span><span class="p">,</span> <span class="n">number_of_states</span><span class="o">=</span><span class="n">number_tclab_states</span><span class="p">)</span>

<span class="c1"># Create the design of experiments object using our experiment instance from above</span>
<span class="n">TC_Lab_DoE_D</span> <span class="o">=</span> <span class="n">DesignOfExperiments</span><span class="p">(</span><span class="n">experiment</span><span class="o">=</span><span class="n">doe_experiment</span><span class="p">,</span> 
                                 <span class="n">step</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
                                 <span class="n">scale_constant_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                 <span class="n">scale_nominal_param_value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                 <span class="n">objective_option</span><span class="o">=</span><span class="s2">&quot;determinant&quot;</span><span class="p">,</span>  <span class="c1"># Now we specify a type of objective, D-opt = &quot;determinant&quot;</span>
                                 <span class="n">prior_FIM</span><span class="o">=</span><span class="n">FIM</span><span class="p">,</span>  <span class="c1"># We use the prior information from the existing experiment!</span>
                                 <span class="n">tee</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>

<span class="n">TC_Lab_DoE_D</span><span class="o">.</span><span class="n">run_doe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1080
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      362
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      180
                     variables with only upper bounds:        0
Total number of equality constraints.................:      362
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 2.65e-01 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1  0.0000000e+00 1.78e-15 5.10e-04  -1.0 5.18e-01    -  9.79e-01 1.00e+00h  1

Number of Iterations....: 1

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   0.0000000000000000e+00    0.0000000000000000e+00
Constraint violation....:   1.7763568394002505e-15    1.7763568394002505e-15
Complementarity.........:   0.0000000000000000e+00    0.0000000000000000e+00
Overall NLP error.......:   1.7763568394002505e-15    1.7763568394002505e-15


Number of objective function evaluations             = 2
Number of objective gradient evaluations             = 2
Number of equality constraint evaluations            = 2
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 2
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 1
Total CPU secs in IPOPT (w/o function evaluations)   =      0.001
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1171
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      453
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      271
                     variables with only upper bounds:        0
Total number of equality constraints.................:      362
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 2.65e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (11025)
   1  0.0000000e+00 1.78e-15 1.94e-04  -1.0 2.57e-01    -  9.84e-01 1.00e+00h  1
   2  0.0000000e+00 1.78e-15 7.29e-17  -1.0 2.13e+00    -  1.00e+00 1.00e+00f  1
   3  0.0000000e+00 1.78e-15 7.05e-18  -2.5 3.48e-01    -  1.00e+00 1.00e+00f  1
   4  0.0000000e+00 1.78e-15 1.97e-19  -3.8 6.45e-01    -  1.00e+00 1.00e+00f  1
   5  0.0000000e+00 1.80e-15 9.69e-21  -5.7 1.39e-01    -  1.00e+00 1.00e+00h  1
   6  0.0000000e+00 1.39e-15 1.26e-22  -8.6 1.52e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 6

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   1.2578315189634477e-22    1.2578315189634477e-22
Constraint violation....:   1.3877787807814457e-15    1.3877787807814457e-15
Complementarity.........:   3.2874888828090638e-09    3.2874888828090638e-09
Overall NLP error.......:   3.2874888828090638e-09    3.2874888828090638e-09


Number of objective function evaluations             = 7
Number of objective gradient evaluations             = 7
Number of equality constraint evaluations            = 7
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 7
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 6
Total CPU secs in IPOPT (w/o function evaluations)   =      0.006
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1171
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      453
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      271
                     variables with only upper bounds:        0
Total number of equality constraints.................:      362
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 2.65e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (11025)
   1  0.0000000e+00 1.78e-15 2.22e-04  -1.0 3.32e-01    -  9.85e-01 1.00e+00h  1
   2  0.0000000e+00 1.78e-15 7.81e-17  -1.0 1.86e+00    -  1.00e+00 1.00e+00f  1
   3  0.0000000e+00 1.78e-15 7.70e-18  -2.5 3.54e-01    -  1.00e+00 1.00e+00f  1
   4  0.0000000e+00 1.78e-15 1.83e-19  -3.8 6.45e-01    -  1.00e+00 1.00e+00f  1
   5  0.0000000e+00 1.78e-15 1.26e-20  -5.7 1.41e-01    -  1.00e+00 1.00e+00h  1
   6  0.0000000e+00 1.78e-15 1.09e-22  -8.6 1.54e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 6

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   1.0867085297415401e-22    1.0867085297415401e-22
Constraint violation....:   1.7763568394002505e-15    1.7763568394002505e-15
Complementarity.........:   3.3107750038258920e-09    3.3107750038258920e-09
Overall NLP error.......:   3.3107750038258920e-09    3.3107750038258920e-09


Number of objective function evaluations             = 7
Number of objective gradient evaluations             = 7
Number of equality constraint evaluations            = 7
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 7
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 6
Total CPU secs in IPOPT (w/o function evaluations)   =      0.006
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1171
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      453
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      271
                     variables with only upper bounds:        0
Total number of equality constraints.................:      362
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 1.80e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (11025)
   1  0.0000000e+00 1.78e-15 1.99e-05  -1.0 3.56e-02    -  9.91e-01 1.00e+00h  1
   2  0.0000000e+00 1.78e-15 6.07e-18  -1.7 6.32e-01    -  1.00e+00 1.00e+00f  1
   3  0.0000000e+00 1.78e-15 1.86e-18  -3.8 1.03e-01    -  1.00e+00 1.00e+00f  1
   4  0.0000000e+00 1.78e-15 1.26e-20  -5.7 1.68e-01    -  1.00e+00 1.00e+00h  1
   5  0.0000000e+00 1.78e-15 1.29e-22  -8.6 1.83e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 5

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   1.2862658525199580e-22    1.2862658525199580e-22
Constraint violation....:   1.7763568394002505e-15    1.7763568394002505e-15
Complementarity.........:   3.4533556448167006e-09    3.4533556448167006e-09
Overall NLP error.......:   3.4533556448167006e-09    3.4533556448167006e-09


Number of objective function evaluations             = 6
Number of objective gradient evaluations             = 6
Number of equality constraint evaluations            = 6
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 6
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 5
Total CPU secs in IPOPT (w/o function evaluations)   =      0.005
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1171
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      453
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      271
                     variables with only upper bounds:        0
Total number of equality constraints.................:      362
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 1.80e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (11025)
   1  0.0000000e+00 1.78e-15 2.58e-05  -1.0 3.52e-02    -  9.91e-01 1.00e+00h  1
   2  0.0000000e+00 1.78e-15 7.81e-18  -1.7 6.32e-01    -  1.00e+00 1.00e+00f  1
   3  0.0000000e+00 1.78e-15 1.55e-18  -3.8 1.03e-01    -  1.00e+00 1.00e+00f  1
   4  0.0000000e+00 1.78e-15 1.68e-20  -5.7 1.68e-01    -  1.00e+00 1.00e+00h  1
   5  0.0000000e+00 1.78e-15 1.57e-22  -8.6 1.83e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 5

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   1.5695752123193700e-22    1.5695752123193700e-22
Constraint violation....:   1.7763568394002505e-15    1.7763568394002505e-15
Complementarity.........:   3.4533025836104998e-09    3.4533025836104998e-09
Overall NLP error.......:   3.4533025836104998e-09    3.4533025836104998e-09


Number of objective function evaluations             = 6
Number of objective gradient evaluations             = 6
Number of equality constraint evaluations            = 6
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 6
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 5
Total CPU secs in IPOPT (w/o function evaluations)   =      0.005
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1171
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      453
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      271
                     variables with only upper bounds:        0
Total number of equality constraints.................:      362
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 2.65e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (11025)
   1  0.0000000e+00 1.78e-15 5.36e-05  -1.0 1.27e-01    -  9.89e-01 1.00e+00h  1
   2  0.0000000e+00 1.78e-15 2.69e-17  -1.7 5.40e-01    -  1.00e+00 1.00e+00f  1
   3  0.0000000e+00 1.78e-15 1.69e-18  -3.8 1.04e-01    -  1.00e+00 1.00e+00f  1
   4  0.0000000e+00 1.78e-15 1.24e-20  -5.7 1.70e-01    -  1.00e+00 1.00e+00h  1
   5  0.0000000e+00 1.78e-15 1.18e-22  -8.6 1.84e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 5

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   1.1808003244194470e-22    1.1808003244194470e-22
Constraint violation....:   1.7763568394002505e-15    1.7763568394002505e-15
Complementarity.........:   3.4600225074837807e-09    3.4600225074837807e-09
Overall NLP error.......:   3.4600225074837807e-09    3.4600225074837807e-09


Number of objective function evaluations             = 6
Number of objective gradient evaluations             = 6
Number of equality constraint evaluations            = 6
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 6
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 5
Total CPU secs in IPOPT (w/o function evaluations)   =      0.005
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1171
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      453
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      271
                     variables with only upper bounds:        0
Total number of equality constraints.................:      362
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 2.65e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (11025)
   1  0.0000000e+00 1.78e-15 4.90e-05  -1.0 1.18e-01    -  9.90e-01 1.00e+00h  1
   2  0.0000000e+00 1.78e-15 2.30e-17  -1.7 5.56e-01    -  1.00e+00 1.00e+00f  1
   3  0.0000000e+00 1.78e-15 1.53e-18  -3.8 1.04e-01    -  1.00e+00 1.00e+00f  1
   4  0.0000000e+00 1.78e-15 1.39e-20  -5.7 1.70e-01    -  1.00e+00 1.00e+00h  1
   5  0.0000000e+00 1.78e-15 1.21e-22  -8.6 1.84e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 5

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   1.2097516458588030e-22    1.2097516458588030e-22
Constraint violation....:   1.7763568394002505e-15    1.7763568394002505e-15
Complementarity.........:   3.4581298725181036e-09    3.4581298725181036e-09
Overall NLP error.......:   3.4581298725181036e-09    3.4581298725181036e-09


Number of objective function evaluations             = 6
Number of objective gradient evaluations             = 6
Number of equality constraint evaluations            = 6
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 6
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 5
Total CPU secs in IPOPT (w/o function evaluations)   =      0.005
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1171
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      453
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      271
                     variables with only upper bounds:        0
Total number of equality constraints.................:      362
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 1.80e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (11025)
   1  0.0000000e+00 1.78e-15 1.99e-05  -1.0 3.64e-02    -  9.91e-01 1.00e+00h  1
   2  0.0000000e+00 1.86e-15 7.81e-18  -1.7 6.31e-01    -  1.00e+00 1.00e+00f  1
   3  0.0000000e+00 1.95e-15 1.46e-18  -3.8 1.03e-01    -  1.00e+00 1.00e+00f  1
   4  0.0000000e+00 1.78e-15 1.18e-20  -5.7 1.68e-01    -  1.00e+00 1.00e+00h  1
   5  0.0000000e+00 1.78e-15 1.57e-22  -8.6 1.83e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 5

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   1.5654393092566049e-22    1.5654393092566049e-22
Constraint violation....:   1.7763568394002505e-15    1.7763568394002505e-15
Complementarity.........:   3.4534443694469787e-09    3.4534443694469787e-09
Overall NLP error.......:   3.4534443694469787e-09    3.4534443694469787e-09


Number of objective function evaluations             = 6
Number of objective gradient evaluations             = 6
Number of equality constraint evaluations            = 6
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 6
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 5
Total CPU secs in IPOPT (w/o function evaluations)   =      0.005
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1171
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      453
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      271
                     variables with only upper bounds:        0
Total number of equality constraints.................:      362
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 1.80e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (11025)
   1  0.0000000e+00 1.78e-15 2.58e-05  -1.0 3.47e-02    -  9.91e-01 1.00e+00h  1
   2  0.0000000e+00 2.66e-15 5.20e-18  -1.7 6.33e-01    -  1.00e+00 1.00e+00f  1
   3  0.0000000e+00 1.78e-15 1.23e-18  -3.8 1.03e-01    -  1.00e+00 1.00e+00f  1
   4  0.0000000e+00 1.78e-15 1.34e-20  -5.7 1.68e-01    -  1.00e+00 1.00e+00h  1
   5  0.0000000e+00 1.78e-15 1.03e-22  -8.6 1.83e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 5

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   1.0288058868628282e-22    1.0288058868628282e-22
Constraint violation....:   1.7763568394002505e-15    1.7763568394002505e-15
Complementarity.........:   3.4532364509691435e-09    3.4532364509691435e-09
Overall NLP error.......:   3.4532364509691435e-09    3.4532364509691435e-09


Number of objective function evaluations             = 6
Number of objective gradient evaluations             = 6
Number of equality constraint evaluations            = 6
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 6
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 5
Total CPU secs in IPOPT (w/o function evaluations)   =      0.015
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:    12464
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:      910

Total number of variables............................:     3907
                     variables with only lower bounds:        0
                variables with lower and upper bounds:     2077
                     variables with only upper bounds:        0
Total number of equality constraints.................:     3907
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 2.78e+01 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (207913)
   1  0.0000000e+00 2.54e+05 5.60e-03  -1.0 3.56e+01    -  9.35e-01 1.00e+00h  1
   2  0.0000000e+00 1.16e-10 4.65e-12  -1.0 2.54e+05    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 2

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   0.0000000000000000e+00    0.0000000000000000e+00
Constraint violation....:   1.1641532182693481e-10    1.1641532182693481e-10
Complementarity.........:   0.0000000000000000e+00    0.0000000000000000e+00
Overall NLP error.......:   1.1641532182693481e-10    1.1641532182693481e-10


Number of objective function evaluations             = 3
Number of objective gradient evaluations             = 3
Number of equality constraint evaluations            = 3
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 3
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 2
Total CPU secs in IPOPT (w/o function evaluations)   =      0.053
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:    13232
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:      930

Reallocating memory for MA57: lfact (249922)
Total number of variables............................:     4008
                     variables with only lower bounds:        4
                variables with lower and upper bounds:     2168
                     variables with only upper bounds:        0
Total number of equality constraints.................:     3917
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0 -1.0736863e+01 1.16e-10 7.55e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1 -1.0736366e+01 5.64e-02 1.09e-02  -1.0 2.33e+02    -  9.90e-01 1.00e+00f  1
   2 -1.0694857e+01 3.87e+02 1.04e-02  -1.0 1.93e+04    -  1.00e+00 1.00e+00f  1
   3 -1.0528361e+01 6.17e+03 1.76e-01  -1.0 7.36e+04    -  1.00e+00 1.00e+00h  1
   4 -1.0540616e+01 6.68e+00 1.21e-03  -1.0 6.09e+03    -  1.00e+00 1.00e+00h  1
   5 -1.0567725e+01 1.33e+01 1.40e-02  -1.7 2.28e+03    -  1.00e+00 1.00e+00h  1
   6 -1.0678122e+01 2.09e+02 5.07e-02  -1.7 8.83e+03    -  1.00e+00 1.00e+00h  1
   7 -1.0678363e+01 8.88e-02 1.30e-04  -1.7 1.33e+02    -  1.00e+00 1.00e+00h  1
   8 -1.0821350e+01 3.45e+02 9.07e-02  -2.5 1.18e+04    -  9.94e-01 1.00e+00h  1
   9 -1.0815878e+01 2.00e+00 6.97e-04  -2.5 1.06e+00  -4.0 1.00e+00 1.00e+00h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  10 -1.1149998e+01 2.83e+03 3.65e-01  -2.5 4.32e+04    -  1.00e+00 1.00e+00h  1
  11 -1.1123669e+01 1.97e+01 9.17e-03  -2.5 2.38e+00  -4.5 1.00e+00 1.00e+00h  1
  12 -1.1262302e+01 3.68e+02 5.38e-02  -2.5 6.86e+03    -  1.00e+00 1.00e+00h  1
  13 -1.1266670e+01 3.66e+02 5.29e-02  -2.5 8.86e+03    -  3.80e-01 1.79e-02h  5
  14 -1.1261373e+01 5.51e+00 6.69e-04  -2.5 1.35e+00  -5.0 1.00e+00 1.00e+00h  1
  15 -1.1342731e+01 2.49e+01 2.02e-02  -2.5 1.90e+03    -  1.00e+00 1.00e+00H  1
  16 -1.1351632e+01 2.25e+01 3.55e-04  -2.5 3.08e+02    -  1.00e+00 1.00e+00h  1
  17 -1.1351558e+01 4.46e-01 5.84e-06  -2.5 6.80e+01    -  1.00e+00 1.00e+00h  1
  18 -1.1351567e+01 1.39e-05 2.83e-08  -2.5 8.47e-01    -  1.00e+00 1.00e+00h  1
  19 -1.1789730e+01 3.78e+03 4.15e-01  -3.8 5.30e+04    -  6.12e-01 1.00e+00f  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  20 -1.2120142e+01 4.73e+03 1.99e-01  -3.8 8.96e+04    -  6.46e-01 6.33e-01h  1
  21 -1.2316219e+01 4.19e+03 1.05e-01  -3.8 9.60e+04    -  5.04e-01 5.83e-01h  1
  22 -1.2294937e+01 5.53e+01 2.94e-03  -3.8 1.03e+01  -5.4 1.00e+00 1.00e+00h  1
  23 -1.2486000e+01 2.11e+03 3.47e-02  -3.8 1.04e+05    -  5.98e-01 5.53e-01h  1
  24 -1.2499469e+01 1.21e+03 1.42e-02  -3.8 3.65e+04    -  7.33e-01 5.90e-01h  1
  25 -1.2503729e+01 1.88e+01 2.39e-04  -3.8 6.46e+03    -  1.00e+00 1.00e+00h  1
  26 -1.2504801e+01 1.03e+00 4.60e-06  -3.8 7.78e+02    -  1.00e+00 1.00e+00h  1
  27 -1.2505229e+01 8.56e-03 9.85e-06  -3.8 1.11e+03    -  1.00e+00 1.00e+00H  1
  28 -1.2505145e+01 3.20e-05 3.49e-08  -3.8 5.71e+01    -  1.00e+00 1.00e+00H  1
  29 -1.2548502e+01 2.04e+02 1.30e-03  -5.7 5.97e+04    -  3.37e-01 3.23e-01f  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  30 -1.2550590e+01 2.23e+02 1.42e-03  -5.7 7.73e+05    -  1.41e-02 5.55e-03h  1
  31 -1.2552042e+01 9.65e-01 2.56e-04  -5.7 1.44e+01  -5.9 5.67e-01 1.00e+00h  1
  32 -1.2552612e+01 9.68e-01 2.97e-04  -5.7 6.68e+04    -  1.40e-01 3.46e-03h  1
  33 -1.2573342e+01 3.88e+01 4.29e-04  -5.7 5.88e+04    -  2.12e-01 1.49e-01f  1
  34 -1.2584389e+01 4.80e+01 4.44e-04  -5.7 4.34e+04    -  2.18e-01 1.23e-01h  1
  35 -1.2591849e+01 8.81e+01 5.49e-04  -5.7 7.39e+04    -  3.17e-01 9.98e-02h  1
  36 -1.2604297e+01 7.52e+01 4.61e-04  -5.7 1.48e+04    -  3.51e-01 2.70e-01h  1
  37 -1.2607331e+01 6.59e+01 5.56e-04  -5.7 1.72e+03    -  3.36e-01 1.26e-01h  1
  38 -1.2613652e+01 4.54e+01 5.69e-04  -5.7 1.56e+03    -  5.59e-01 3.28e-01h  1
  39 -1.2625245e+01 6.37e+00 9.36e-05  -5.7 8.64e+02    -  1.00e+00 9.83e-01h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  40 -1.2624822e+01 6.53e-02 4.15e-07  -5.7 3.20e+02    -  1.00e+00 1.00e+00h  1
  41 -1.2624828e+01 6.53e-05 1.17e-09  -5.7 1.00e+01    -  1.00e+00 1.00e+00h  1
  42 -1.2624828e+01 1.89e-10 1.90e-11  -5.7 1.40e-02    -  1.00e+00 1.00e+00h  1
  43 -1.2625975e+01 7.36e-02 9.08e-07  -8.6 1.84e+02    -  9.54e-01 9.46e-01f  1
  44 -1.2626039e+01 4.59e-04 5.48e-09  -8.6 2.31e+01    -  1.00e+00 1.00e+00h  1
  45 -1.2626040e+01 1.98e-09 6.18e-11  -8.6 5.79e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 45

                                   (scaled)                 (unscaled)
Objective...............:  -1.2626039562353837e+01   -1.2626039562353837e+01
Dual infeasibility......:   6.1759819480755596e-11    6.1759819480755596e-11
Constraint violation....:   1.1176692551792170e-09    1.9790604710578918e-09
Complementarity.........:   2.5059118530201231e-09    2.5059118530201231e-09
Overall NLP error.......:   2.5059118530201231e-09    2.5059118530201231e-09


Number of objective function evaluations             = 54
Number of objective gradient evaluations             = 46
Number of equality constraint evaluations            = 55
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 46
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 45
Total CPU secs in IPOPT (w/o function evaluations)   =      0.905
Total CPU secs in NLP function evaluations           =      0.009

EXIT: Optimal Solution Found.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract and plot the results using our custom function</span>
<span class="c1">### BEGIN SOLUTION</span>
<span class="n">dopt_pyomo_doe_results</span> <span class="o">=</span> <span class="n">extract_plot_results</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">TC_Lab_DoE_D</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">scenario_blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="c1">### END SOLUTION</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/34f05752baaa37748e892d4315cb8483d7d827e7c3d2aea101c7a1b8c3e10aa7.png" src="../_images/34f05752baaa37748e892d4315cb8483d7d827e7c3d2aea101c7a1b8c3e10aa7.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0421 Watts/degC
Ub = 0.0094 Watts/degC
CpH = 6.0274 Joules/degC
CpS = 0.1714 Joules/degC
 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the FIM at the optimal solution</span>
<span class="c1">### BEGIN SOLUTION</span>
<span class="n">results_summary</span><span class="p">(</span><span class="n">TC_Lab_DoE_D</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;FIM&#39;</span><span class="p">])</span>
<span class="c1">### END SOLUTION</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>======Results Summary======
Four design criteria log10() value:
A-optimality: 5.967636028118886
D-optimality: 12.62603956232522
E-optimality: -1.8550827141000377
Modified E-optimality: 7.772789117677075

FIM:
 [[818563.0801634969, -620.1786056149823, -79956.24482342416, -3266.450673590944], [-620.1786056149823, 4866.710384232659, 15971.220200977912, 5229.79120056382], [-79956.24482342416, 15971.220200977912, 99087.96962372029, 18696.801379926546], [-3266.450673590944, 5229.79120056382, 18696.801379926546, 5670.408112132706]]

eigenvalues:
 [8.27382639e+05 9.70342163e+04 3.77129903e+03 1.39610244e-02]

eigenvectors:
 [[-9.93977609e-01  1.07151272e-01 -2.29590047e-02  4.07808937e-05]
 [ 2.91390791e-03  1.76638285e-01  6.96995197e-01 -6.94973468e-01]
 [ 1.09354088e-01  9.57308108e-01 -2.66548727e-01 -2.35509312e-02]
 [ 6.45796596e-03  2.02184836e-01  6.65298697e-01  7.18649588e-01]]
</pre></div>
</div>
</div>
</div>
<p><strong>Discussion:</strong> How do these results compare to <a class="reference internal" href="../notebooks/doe_exercise.html"><span class="doc std std-doc">our previous analysis</span></a>?</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./exercise_solutions"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="parmest_exercise.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Exercise: ParmEst</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-and-explore-experimental-data-step-test">Load and explore experimental data (step test)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analyze-fim-with-pyomo-doe-at-initial-point-step-test">Analyze FIM with Pyomo.DoE at initial point (step test)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimize-the-next-experiment-a-optimality">Optimize the next experiment (A-optimality)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimize-the-next-experiment-d-optimality">Optimize the next experiment (D-optimality)</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Alexander Dowling
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>