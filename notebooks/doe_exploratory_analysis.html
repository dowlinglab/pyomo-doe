

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Pyomo.DoE: Exploratory Analysis &#8212; Pyomo.DoE Workshop and Tutorials</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/doe_exploratory_analysis';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Pyomo.DoE: Optimization" href="doe_optimize.html" />
    <link rel="prev" title="Optimal Experiment Design" href="../mbdoe.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../Readme.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/PyomoDoE-sm.png" class="logo__image only-light" alt="Pyomo.DoE Workshop and Tutorials - Home"/>
    <script>document.write(`<img src="../_static/PyomoDoE-sm.png" class="logo__image only-dark" alt="Pyomo.DoE Workshop and Tutorials - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../Readme.html">
                    Optimizing Experiments with Pyomo.DoE
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../tclab.html">Modeling Example: TCLab</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="tclab_model.html">TCLab Mathematical Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="numpy_simulation.html">Modeling with Numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyomo_simulation.html">Modeling with Pyomo</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="experiment_abstraction.html">Experiment Abstraction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../regression.html">Parameter Estimation</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="parmest.html">Nonlinear Regression with ParmEst</a></li>
<li class="toctree-l2"><a class="reference internal" href="parmest_exercise.html">Exercise: ParmEst</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../mbdoe.html">Optimal Experiment Design</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Pyomo.DoE: Exploratory Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="doe_optimize.html">Pyomo.DoE: Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="doe_exercise.html">Exercise: Pyomo.DoE</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../exercises.html">Exercise Solutions</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../exercise_solutions/parmest_exercise.html">Exercise: ParmEst</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exercise_solutions/doe_exercise.html">Exercise: Pyomo.DoE</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/dowlinglab/pyomo-doe/blob/main/notebooks/doe_exploratory_analysis.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/dowlinglab/pyomo-doe" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/dowlinglab/pyomo-doe/issues/new?title=Issue%20on%20page%20%2Fnotebooks/doe_exploratory_analysis.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/doe_exploratory_analysis.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Pyomo.DoE: Exploratory Analysis</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-experimental-data-sine-test">Load experimental data (sine test)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analyze-fim-with-pyomo-doe-at-initial-point-sine-test">Analyze FIM with Pyomo.DoE at initial point (sine test)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reusing-the-experiment-object-used-for-parameter-estimation">Reusing the Experiment object used for parameter estimation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-parameterized-sine-wave-experiment">Define parameterized sine wave experiment</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#perform-sensitivity-analysis-to-sine-wave-frequency-and-period">Perform sensitivity analysis to sine wave frequency and period</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-and-interpret-sensitivity-analysis-results">Visualize and interpret sensitivity analysis results</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="pyomo-doe-exploratory-analysis">
<h1>Pyomo.DoE: Exploratory Analysis<a class="headerlink" href="#pyomo-doe-exploratory-analysis" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">SMALL_SIZE</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">MEDIUM_SIZE</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">BIGGER_SIZE</span> <span class="o">=</span> <span class="mi">18</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">SMALL_SIZE</span><span class="p">)</span>  <span class="c1"># controls default text sizes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="n">SMALL_SIZE</span><span class="p">)</span>  <span class="c1"># fontsize of the axes title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">MEDIUM_SIZE</span><span class="p">)</span>  <span class="c1"># fontsize of the x and y labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;xtick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">SMALL_SIZE</span><span class="p">)</span>  <span class="c1"># fontsize of the tick labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;ytick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">SMALL_SIZE</span><span class="p">)</span>  <span class="c1"># fontsize of the tick labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;legend&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">SMALL_SIZE</span><span class="p">)</span>  <span class="c1"># legend fontsize</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;figure&#39;</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="n">BIGGER_SIZE</span><span class="p">)</span>  <span class="c1"># fontsize of the figure title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>

<span class="c1"># If running on Google Colab, install Pyomo and Ipopt via IDAES</span>
<span class="n">on_colab</span> <span class="o">=</span> <span class="s2">&quot;google.colab&quot;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span>
<span class="k">if</span> <span class="n">on_colab</span><span class="p">:</span>
    <span class="o">!</span>wget<span class="w"> </span><span class="s2">&quot;https://raw.githubusercontent.com/dowlinglab/pyomo-doe/main/notebooks/tclab_pyomo.py&quot;</span>

<span class="c1"># import TCLab model, simulation, and data analysis functions</span>
<span class="kn">from</span> <span class="nn">tclab_pyomo</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">TC_Lab_data</span><span class="p">,</span>
    <span class="n">TC_Lab_experiment</span><span class="p">,</span>
    <span class="n">extract_results</span><span class="p">,</span>
    <span class="n">extract_plot_results</span><span class="p">,</span>
    <span class="n">results_summary</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># set default number of states in the TCLab model</span>
<span class="n">number_tclab_states</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<section id="load-experimental-data-sine-test">
<h2>Load experimental data (sine test)<a class="headerlink" href="#load-experimental-data-sine-test" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="k">if</span> <span class="n">on_colab</span><span class="p">:</span>
    <span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/dowlinglab/pyomo-doe/main/data/tclab_sine_test_5min_period.csv&quot;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">file</span> <span class="o">=</span> <span class="s1">&#39;../data/tclab_sine_test_5min_period.csv&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
      <th>T1</th>
      <th>T2</th>
      <th>Q1</th>
      <th>Q2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.00</td>
      <td>22.2</td>
      <td>22.2</td>
      <td>50</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.01</td>
      <td>22.2</td>
      <td>22.2</td>
      <td>51</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.01</td>
      <td>22.2</td>
      <td>22.2</td>
      <td>52</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.00</td>
      <td>22.2</td>
      <td>22.2</td>
      <td>53</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.01</td>
      <td>22.2</td>
      <td>22.2</td>
      <td>54</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="s1">&#39;T2&#39;</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Temperature (°C)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fbf2644f6f803238293870aec0099c1bb77225c820bcc42071fca6f36db6f2e6.png" src="../_images/fbf2644f6f803238293870aec0099c1bb77225c820bcc42071fca6f36db6f2e6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Heater Power (%)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ab15113c9ac37b32ee9820b6e12aa73656cb2294c8fbe7117425cffc67afcbcb.png" src="../_images/ab15113c9ac37b32ee9820b6e12aa73656cb2294c8fbe7117425cffc67afcbcb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Here, we will induce a step size of 6 seconds, as to not give too many </span>
<span class="c1"># degrees of freedom for experimental design.</span>
<span class="n">skip</span> <span class="o">=</span> <span class="mi">6</span>

<span class="c1"># Create the data object considering the new control points every 6 seconds</span>
<span class="n">tc_data</span> <span class="o">=</span> <span class="n">TC_Lab_data</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Sine Wave Test for Heater 1&quot;</span><span class="p">,</span>
    <span class="n">time</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[::</span><span class="n">skip</span><span class="p">],</span>
    <span class="n">T1</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;T1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[::</span><span class="n">skip</span><span class="p">],</span>
    <span class="n">u1</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Q1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[::</span><span class="n">skip</span><span class="p">],</span>
    <span class="n">P1</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
    <span class="n">TS1_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">T2</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;T2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[::</span><span class="n">skip</span><span class="p">],</span>
    <span class="n">u2</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Q2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[::</span><span class="n">skip</span><span class="p">],</span>
    <span class="n">P2</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
    <span class="n">TS2_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">Tamb</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;T1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="analyze-fim-with-pyomo-doe-at-initial-point-sine-test">
<h2>Analyze FIM with Pyomo.DoE at initial point (sine test)<a class="headerlink" href="#analyze-fim-with-pyomo-doe-at-initial-point-sine-test" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load Pyomo.DoE class</span>
<span class="kn">from</span> <span class="nn">pyomo.contrib.doe</span> <span class="kn">import</span> <span class="n">DesignOfExperiments</span>

<span class="kn">from</span> <span class="nn">pyomo.environ</span> <span class="kn">import</span> <span class="n">SolverFactory</span>

<span class="c1"># Copied from previous notebook</span>
<span class="n">theta_values</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Ua&#39;</span><span class="p">:</span> <span class="mf">0.0417051733576387</span><span class="p">,</span>
    <span class="s1">&#39;Ub&#39;</span><span class="p">:</span> <span class="mf">0.009440714239773074</span><span class="p">,</span>
    <span class="s1">&#39;inv_CpH&#39;</span><span class="p">:</span> <span class="mf">0.1659093525658045</span><span class="p">,</span>
    <span class="s1">&#39;inv_CpS&#39;</span><span class="p">:</span> <span class="mf">5.8357556063605465</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="reusing-the-experiment-object-used-for-parameter-estimation">
<h2>Reusing the Experiment object used for parameter estimation<a class="headerlink" href="#reusing-the-experiment-object-used-for-parameter-estimation" title="Permalink to this heading">#</a></h2>
<p>Recall that we utilized the experiment object during parameter estimation. From the Experiment Abstraction notebook, we labeled the important sets:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">experiment_inputs</span></code> - The experimental design decisions (control variables <span class="math notranslate nohighlight">\(u_2\)</span> in this case)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">experiment_outputs</span></code> - The values measured during the experiment (temperature sensor data <span class="math notranslate nohighlight">\(T_{S1}\)</span> in this case)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">measurement_error</span></code> - The error associated with individual values measured during the experiment</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">unknown_parameters</span></code> - Those parameters in the model that are estimated using the measured values during the experiment (heat transfer coefficients (<span class="math notranslate nohighlight">\(U_a\)</span> and <span class="math notranslate nohighlight">\(U_b\)</span>) and heat capacities (<span class="math notranslate nohighlight">\(C^H_p\)</span> and <span class="math notranslate nohighlight">\(C^S_p\)</span>) in this case)</p></li>
</ul>
<p>This means we can use the same experiment object for optimal DoE! Therefore, we go about creating this object in the same way, except we will specify the values of the unknown parameters, <span class="math notranslate nohighlight">\(\theta\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create experiment object for design of experiments</span>
<span class="n">doe_experiment</span> <span class="o">=</span> <span class="n">TC_Lab_experiment</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">tc_data</span><span class="p">,</span> <span class="n">theta_initial</span><span class="o">=</span><span class="n">theta_values</span><span class="p">,</span> <span class="n">number_of_states</span><span class="o">=</span><span class="n">number_tclab_states</span><span class="p">)</span>

<span class="c1"># Create the design of experiments object using our experiment instance from above</span>
<span class="n">TC_Lab_DoE</span> <span class="o">=</span> <span class="n">DesignOfExperiments</span><span class="p">(</span><span class="n">experiment</span><span class="o">=</span><span class="n">doe_experiment</span><span class="p">,</span> 
                                 <span class="n">step</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
                                 <span class="n">scale_constant_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                 <span class="n">scale_nominal_param_value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                 <span class="n">tee</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>

<span class="n">FIM</span> <span class="o">=</span> <span class="n">TC_Lab_DoE</span><span class="o">.</span><span class="n">compute_FIM</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sequential&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_summary</span><span class="p">(</span><span class="n">FIM</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>======Results Summary======
Four design criteria log10() value:
A-optimality: 5.773228885932493
D-optimality: 12.308607163946094
E-optimality: -1.793074158088514
Modified E-optimality: 7.514721752736364

FIM:
 [[517225.40941304   1360.01262476 -66404.72541298  -1002.47319402]
 [  1360.01262476   5004.3737258   12379.2662576    5238.40389773]
 [-66404.72541298  12379.2662576   65481.16908635  14190.01468139]
 [ -1002.47319402   5238.40389773  14190.01468139   5526.94375493]]

eigenvalues:
 [5.26802218e+05 6.26035823e+04 3.83207978e+03 1.61037063e-02]

eigenvectors:
 [[-9.89752804e-01 -1.35949591e-01  4.36702406e-02 -7.52086327e-05]
 [ 8.63262440e-04 -2.26164575e-01 -6.85698047e-01 -6.91857665e-01]
 [ 1.42671125e-01 -9.31600001e-01  3.33329462e-01 -2.56487437e-02]
 [ 5.79584008e-03 -2.49977462e-01 -6.45602485e-01  7.21578207e-01]]
</pre></div>
</div>
</div>
</div>
<p>We can see the FIM of the sine wave experiment is rank deficient with one eigenvalue that is numerically zero. We see the corresponding eigenvector points in the direction of the 2nd and 4th parameters, <code class="docutils literal notranslate"><span class="pre">U_b</span></code> and <code class="docutils literal notranslate"><span class="pre">inv_CpS</span></code>. This means the experiment alone does not contain enough information to uniquely estimate all of the parameters if the model.</p>
<p>Why does it make sense that <span class="math notranslate nohighlight">\(U_b C_p^S\)</span> is difficult to estimate?</p>
</section>
<section id="define-parameterized-sine-wave-experiment">
<h2>Define parameterized sine wave experiment<a class="headerlink" href="#define-parameterized-sine-wave-experiment" title="Permalink to this heading">#</a></h2>
<p>Can we further optimize the sine wave test to improve the information content? Let’s define the parameterized sine wave as:</p>
<div class="math notranslate nohighlight">
\[
u(t) = 50 + a \sin(\frac{2 \pi}{60 p} t)
\]</div>
<p>where <span class="math notranslate nohighlight">\(a\)</span> is the amplitude (% power), <span class="math notranslate nohighlight">\(p\)</span> is the period (minutes), <span class="math notranslate nohighlight">\(t\)</span> is the time (seconds), and 60 is a conversion factor (seconds/minute).</p>
<p>Let’s look at the information content of <span class="math notranslate nohighlight">\(p = 5\)</span> minute and <span class="math notranslate nohighlight">\(a = 50\)</span> %.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create experiment object for design of experiments, now including the sine period and amplitude</span>
<span class="n">sine_period</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">sine_amplitude</span> <span class="o">=</span> <span class="mi">50</span>

<span class="n">doe_experiment</span> <span class="o">=</span> <span class="n">TC_Lab_experiment</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">tc_data</span><span class="p">,</span> 
    <span class="n">theta_initial</span><span class="o">=</span><span class="n">theta_values</span><span class="p">,</span> 
    <span class="n">number_of_states</span><span class="o">=</span><span class="n">number_tclab_states</span><span class="p">,</span> 
    <span class="n">sine_amplitude</span><span class="o">=</span><span class="n">sine_amplitude</span><span class="p">,</span>
    <span class="n">sine_period</span><span class="o">=</span><span class="n">sine_period</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Create the design of experiments object using our experiment instance from above</span>
<span class="n">TC_Lab_DoE</span> <span class="o">=</span> <span class="n">DesignOfExperiments</span><span class="p">(</span><span class="n">experiment</span><span class="o">=</span><span class="n">doe_experiment</span><span class="p">,</span> 
                                 <span class="n">step</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
                                 <span class="n">scale_constant_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                 <span class="n">scale_nominal_param_value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                 <span class="n">tee</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>

<span class="n">FIM</span> <span class="o">=</span> <span class="n">TC_Lab_DoE</span><span class="o">.</span><span class="n">compute_FIM</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sequential&#39;</span><span class="p">)</span>

<span class="n">pyomo_doe_results</span> <span class="o">=</span> <span class="n">extract_plot_results</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">TC_Lab_DoE</span><span class="o">.</span><span class="n">compute_FIM_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9caeb9bf9dd17f8f2ca8fa722a1a041a80ef970943b5533707f12c0d0f0f2c52.png" src="../_images/9caeb9bf9dd17f8f2ca8fa722a1a041a80ef970943b5533707f12c0d0f0f2c52.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 5 minutes
u1_amplitude = 50 % power
 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_summary</span><span class="p">(</span><span class="n">FIM</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>======Results Summary======
Four design criteria log10() value:
A-optimality: 5.780415236175106
D-optimality: 12.321221800291308
E-optimality: -1.7900021808076725
Modified E-optimality: 7.519483927119054

FIM:
 [[526615.93104322   1269.39017779 -67742.74020183  -1135.81765702]
 [  1269.39017779   5002.22184096  12430.15508962   5238.07864931]
 [-67742.74020183  12430.15508962  65988.9240756   14256.31640107]
 [ -1135.81765702   5238.07864931  14256.31640107   5528.90185893]]

eigenvalues:
 [5.36391326e+05 6.29165915e+04 3.82804512e+03 1.62180195e-02]

eigenvectors:
 [[-9.89741606e-01 -1.36133505e-01  4.33499251e-02 -7.45344234e-05]
 [ 1.03341873e-03 -2.25549256e-01 -6.85896472e-01 -6.91861616e-01]
 [ 1.42740848e-01 -9.31879387e-01  3.32518176e-01 -2.56421659e-02]
 [ 5.96112603e-03 -2.49391279e-01 -6.45831616e-01  7.21574652e-01]]
</pre></div>
</div>
</div>
</div>
<p>This parameterization reproduced the original sine wave experiment. As expected, the FIM is still rank deficient.</p>
</section>
<section id="perform-sensitivity-analysis-to-sine-wave-frequency-and-period">
<h2>Perform sensitivity analysis to sine wave frequency and period<a class="headerlink" href="#perform-sensitivity-analysis-to-sine-wave-frequency-and-period" title="Permalink to this heading">#</a></h2>
<p>Now let’s perform a sensitivity analysis over <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(a\)</span>. <code class="docutils literal notranslate"><span class="pre">Pyomo.DoE</span></code> includes functions to automate this analysis including visualization. In our experience, an exploratory analysis like this is especially helpful to develop intuition about the physical system and model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Design variable ranges as lists</span>
<span class="n">quick_run</span> <span class="o">=</span> <span class="kc">False</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">quick_run</span><span class="p">:</span>
    <span class="c1"># Larger sensitivity analysis with more detailed plots</span>
    <span class="n">design_ranges</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;u1_period&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
        <span class="s2">&quot;u1_amplitude&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">45</span><span class="p">],</span>
    <span class="p">}</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># Faster sensitivity analysis, good for debugging</span>
    <span class="n">design_ranges</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;u1_period&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;u1_amplitude&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">]}</span>

<span class="n">sensi_opt</span> <span class="o">=</span> <span class="s2">&quot;sequential_finite&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">FIM_results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">data_period</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">data_amplitude</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># Grid search</span>
<span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="n">design_ranges</span><span class="p">[</span><span class="s2">&quot;u1_period&quot;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">amplitude</span> <span class="ow">in</span> <span class="n">design_ranges</span><span class="p">[</span><span class="s2">&quot;u1_amplitude&quot;</span><span class="p">]:</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=======Iteration Number: </span><span class="si">{}</span><span class="s2"> =======&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">count</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Design variable values for this iteration: (Period: </span><span class="si">{}</span><span class="s2">, Amplitude: </span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">period</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">))</span>

        <span class="n">data_period</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>
        <span class="n">data_amplitude</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">amplitude</span><span class="p">)</span>
        
        <span class="n">doe_experiment</span> <span class="o">=</span> <span class="n">TC_Lab_experiment</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">tc_data</span><span class="p">,</span> 
            <span class="n">theta_initial</span><span class="o">=</span><span class="n">theta_values</span><span class="p">,</span> 
            <span class="n">number_of_states</span><span class="o">=</span><span class="n">number_tclab_states</span><span class="p">,</span> 
            <span class="n">sine_amplitude</span><span class="o">=</span><span class="n">amplitude</span><span class="p">,</span>
            <span class="n">sine_period</span><span class="o">=</span><span class="n">period</span><span class="p">,</span>
        <span class="p">)</span>
        
        <span class="c1"># Create the design of experiments object using our experiment instance from above</span>
        <span class="n">TC_Lab_DoE</span> <span class="o">=</span> <span class="n">DesignOfExperiments</span><span class="p">(</span><span class="n">experiment</span><span class="o">=</span><span class="n">doe_experiment</span><span class="p">,</span> 
                                         <span class="n">step</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
                                         <span class="n">scale_constant_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                         <span class="n">scale_nominal_param_value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                         <span class="n">tee</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>
        
        <span class="n">FIM</span> <span class="o">=</span> <span class="n">TC_Lab_DoE</span><span class="o">.</span><span class="n">compute_FIM</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sequential&#39;</span><span class="p">)</span>
        
        <span class="n">pyomo_doe_results</span> <span class="o">=</span> <span class="n">extract_plot_results</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">TC_Lab_DoE</span><span class="o">.</span><span class="n">compute_FIM_model</span><span class="p">)</span>

        <span class="n">FIM_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FIM</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=======Iteration Number: 1 =======
Design variable values for this iteration: (Period: 1, Amplitude: 15)
</pre></div>
</div>
<img alt="../_images/1208d8731e9b34c2f132f56a816b3bf1471a6b99e0306d3d1f3216275741e5e4.png" src="../_images/1208d8731e9b34c2f132f56a816b3bf1471a6b99e0306d3d1f3216275741e5e4.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 1 minutes
u1_amplitude = 15 % power
 
=======Iteration Number: 2 =======
Design variable values for this iteration: (Period: 1, Amplitude: 25)
</pre></div>
</div>
<img alt="../_images/53248ac05258492b512cb74832f9e84549201d248d8a66340ab319fff195fed2.png" src="../_images/53248ac05258492b512cb74832f9e84549201d248d8a66340ab319fff195fed2.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 1 minutes
u1_amplitude = 25 % power
 
=======Iteration Number: 3 =======
Design variable values for this iteration: (Period: 1, Amplitude: 35)
</pre></div>
</div>
<img alt="../_images/d69f277783756c4cb4853e1acfd897e8de65592c13d6ead30a83016151f0501b.png" src="../_images/d69f277783756c4cb4853e1acfd897e8de65592c13d6ead30a83016151f0501b.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 1 minutes
u1_amplitude = 35 % power
 
=======Iteration Number: 4 =======
Design variable values for this iteration: (Period: 1, Amplitude: 45)
</pre></div>
</div>
<img alt="../_images/73e0e2059b82e5a5edbb0c51a40cb229c07de3dace62410f078f4d6feff64917.png" src="../_images/73e0e2059b82e5a5edbb0c51a40cb229c07de3dace62410f078f4d6feff64917.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 1 minutes
u1_amplitude = 45 % power
 
=======Iteration Number: 5 =======
Design variable values for this iteration: (Period: 2, Amplitude: 15)
</pre></div>
</div>
<img alt="../_images/aa4c287cda3bcde3f130368b4a2e5e6e3c5db415be40317f183cf8bd4579ffc5.png" src="../_images/aa4c287cda3bcde3f130368b4a2e5e6e3c5db415be40317f183cf8bd4579ffc5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 2 minutes
u1_amplitude = 15 % power
 
=======Iteration Number: 6 =======
Design variable values for this iteration: (Period: 2, Amplitude: 25)
</pre></div>
</div>
<img alt="../_images/47dad7911cdf3ed05fdd73801776220d54284fe07bcb9ad1a85a3497c18b3a1c.png" src="../_images/47dad7911cdf3ed05fdd73801776220d54284fe07bcb9ad1a85a3497c18b3a1c.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 2 minutes
u1_amplitude = 25 % power
 
=======Iteration Number: 7 =======
Design variable values for this iteration: (Period: 2, Amplitude: 35)
</pre></div>
</div>
<img alt="../_images/28ade973eb3558a2447e33c76a45c02dc4b979f6e3d3ac2b1a330a5362aca55e.png" src="../_images/28ade973eb3558a2447e33c76a45c02dc4b979f6e3d3ac2b1a330a5362aca55e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 2 minutes
u1_amplitude = 35 % power
 
=======Iteration Number: 8 =======
Design variable values for this iteration: (Period: 2, Amplitude: 45)
</pre></div>
</div>
<img alt="../_images/ed3a9e265705587da33c16e5157d0ffdaf32025695917eb6253ab69b252d0209.png" src="../_images/ed3a9e265705587da33c16e5157d0ffdaf32025695917eb6253ab69b252d0209.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 2 minutes
u1_amplitude = 45 % power
 
=======Iteration Number: 9 =======
Design variable values for this iteration: (Period: 3, Amplitude: 15)
</pre></div>
</div>
<img alt="../_images/506418d6a2f1f2b7cb14fa794d94467c55c8816aa21226d6828624bc942823f7.png" src="../_images/506418d6a2f1f2b7cb14fa794d94467c55c8816aa21226d6828624bc942823f7.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 3 minutes
u1_amplitude = 15 % power
 
=======Iteration Number: 10 =======
Design variable values for this iteration: (Period: 3, Amplitude: 25)
</pre></div>
</div>
<img alt="../_images/b39c42ea0e360f6cb0e4582f16196e780b19c87d790d94661001e8552e63836d.png" src="../_images/b39c42ea0e360f6cb0e4582f16196e780b19c87d790d94661001e8552e63836d.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 3 minutes
u1_amplitude = 25 % power
 
=======Iteration Number: 11 =======
Design variable values for this iteration: (Period: 3, Amplitude: 35)
</pre></div>
</div>
<img alt="../_images/903b18e36e2b8c4cb057bf21219dcc96ecbfc51013526b2c5f67763856648950.png" src="../_images/903b18e36e2b8c4cb057bf21219dcc96ecbfc51013526b2c5f67763856648950.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 3 minutes
u1_amplitude = 35 % power
 
=======Iteration Number: 12 =======
Design variable values for this iteration: (Period: 3, Amplitude: 45)
</pre></div>
</div>
<img alt="../_images/7feb7785c27f730133b314faad8722a6f7a0f770d0ba3d40022df783e1182aaa.png" src="../_images/7feb7785c27f730133b314faad8722a6f7a0f770d0ba3d40022df783e1182aaa.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 3 minutes
u1_amplitude = 45 % power
 
=======Iteration Number: 13 =======
Design variable values for this iteration: (Period: 4, Amplitude: 15)
</pre></div>
</div>
<img alt="../_images/8058d05f67728058a794ef62b53036da46405c07dcc9f4728f2f1f77829da67a.png" src="../_images/8058d05f67728058a794ef62b53036da46405c07dcc9f4728f2f1f77829da67a.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 4 minutes
u1_amplitude = 15 % power
 
=======Iteration Number: 14 =======
Design variable values for this iteration: (Period: 4, Amplitude: 25)
</pre></div>
</div>
<img alt="../_images/ebb639a2816e8d2625ede7155fde378ff405c29e7a336627cad96bc38d3da0f3.png" src="../_images/ebb639a2816e8d2625ede7155fde378ff405c29e7a336627cad96bc38d3da0f3.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 4 minutes
u1_amplitude = 25 % power
 
=======Iteration Number: 15 =======
Design variable values for this iteration: (Period: 4, Amplitude: 35)
</pre></div>
</div>
<img alt="../_images/9215d0075b6860e2b928f52f054a6e8f799913406c185a2cdd80e7f46e39458c.png" src="../_images/9215d0075b6860e2b928f52f054a6e8f799913406c185a2cdd80e7f46e39458c.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 4 minutes
u1_amplitude = 35 % power
 
=======Iteration Number: 16 =======
Design variable values for this iteration: (Period: 4, Amplitude: 45)
</pre></div>
</div>
<img alt="../_images/b09e109e2d9e8d525f888d29fdbe7dbc0d8d10f221685ac86496ab721ae56a4e.png" src="../_images/b09e109e2d9e8d525f888d29fdbe7dbc0d8d10f221685ac86496ab721ae56a4e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 4 minutes
u1_amplitude = 45 % power
 
=======Iteration Number: 17 =======
Design variable values for this iteration: (Period: 5, Amplitude: 15)
</pre></div>
</div>
<img alt="../_images/355547dd114162c8e74369744168295ad38291c9f2a336a8bbebd3def471306d.png" src="../_images/355547dd114162c8e74369744168295ad38291c9f2a336a8bbebd3def471306d.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 5 minutes
u1_amplitude = 15 % power
 
=======Iteration Number: 18 =======
Design variable values for this iteration: (Period: 5, Amplitude: 25)
</pre></div>
</div>
<img alt="../_images/a52285cbe7c41d093f3c69cfa3d13862b9a3a0a6845d9e79a3378c87e3542910.png" src="../_images/a52285cbe7c41d093f3c69cfa3d13862b9a3a0a6845d9e79a3378c87e3542910.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 5 minutes
u1_amplitude = 25 % power
 
=======Iteration Number: 19 =======
Design variable values for this iteration: (Period: 5, Amplitude: 35)
</pre></div>
</div>
<img alt="../_images/a71bc7c2ca8d3a2104233ee09f2bd21ead0cc06fff2aa37f50a8a04f1c0add91.png" src="../_images/a71bc7c2ca8d3a2104233ee09f2bd21ead0cc06fff2aa37f50a8a04f1c0add91.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 5 minutes
u1_amplitude = 35 % power
 
=======Iteration Number: 20 =======
Design variable values for this iteration: (Period: 5, Amplitude: 45)
</pre></div>
</div>
<img alt="../_images/ee800c1c84797faac5cdaa495850b0ca1ebbc4860a0fc860a64afc16319e84c7.png" src="../_images/ee800c1c84797faac5cdaa495850b0ca1ebbc4860a0fc860a64afc16319e84c7.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 5 minutes
u1_amplitude = 45 % power
 
=======Iteration Number: 21 =======
Design variable values for this iteration: (Period: 6, Amplitude: 15)
</pre></div>
</div>
<img alt="../_images/3a8d4194fc31548471ccfa2ff16709bb6592001d1d228416b46396d01ba026ed.png" src="../_images/3a8d4194fc31548471ccfa2ff16709bb6592001d1d228416b46396d01ba026ed.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 6 minutes
u1_amplitude = 15 % power
 
=======Iteration Number: 22 =======
Design variable values for this iteration: (Period: 6, Amplitude: 25)
</pre></div>
</div>
<img alt="../_images/8f65e8eb2faa736a462103656d2c6bb7ffb21d35f57ff45619d662d49dc0ad1a.png" src="../_images/8f65e8eb2faa736a462103656d2c6bb7ffb21d35f57ff45619d662d49dc0ad1a.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 6 minutes
u1_amplitude = 25 % power
 
=======Iteration Number: 23 =======
Design variable values for this iteration: (Period: 6, Amplitude: 35)
</pre></div>
</div>
<img alt="../_images/0aa7adb0b4cafc9061b0a8ee4a18e2e7266235f47276890972896d508b31fcb4.png" src="../_images/0aa7adb0b4cafc9061b0a8ee4a18e2e7266235f47276890972896d508b31fcb4.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 6 minutes
u1_amplitude = 35 % power
 
=======Iteration Number: 24 =======
Design variable values for this iteration: (Period: 6, Amplitude: 45)
</pre></div>
</div>
<img alt="../_images/f6ebb102d378503d9d0dcfe13d75b892e884d4959877f58d350d5d3d96882724.png" src="../_images/f6ebb102d378503d9d0dcfe13d75b892e884d4959877f58d350d5d3d96882724.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 6 minutes
u1_amplitude = 45 % power
 
=======Iteration Number: 25 =======
Design variable values for this iteration: (Period: 7, Amplitude: 15)
</pre></div>
</div>
<img alt="../_images/cca0a103c3f33cae93c5582fa0f230bfc7faa18358f1f660cda8a1ec4d201688.png" src="../_images/cca0a103c3f33cae93c5582fa0f230bfc7faa18358f1f660cda8a1ec4d201688.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 7 minutes
u1_amplitude = 15 % power
 
=======Iteration Number: 26 =======
Design variable values for this iteration: (Period: 7, Amplitude: 25)
</pre></div>
</div>
<img alt="../_images/e5b3f5fb6611198c443dbf643313c5840b85beaec747b453e4e90b5687d885ed.png" src="../_images/e5b3f5fb6611198c443dbf643313c5840b85beaec747b453e4e90b5687d885ed.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 7 minutes
u1_amplitude = 25 % power
 
=======Iteration Number: 27 =======
Design variable values for this iteration: (Period: 7, Amplitude: 35)
</pre></div>
</div>
<img alt="../_images/e66e346bc0ab60beac6235ce9fb96b396b690b25cd36fad1e86194af047d891b.png" src="../_images/e66e346bc0ab60beac6235ce9fb96b396b690b25cd36fad1e86194af047d891b.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 7 minutes
u1_amplitude = 35 % power
 
=======Iteration Number: 28 =======
Design variable values for this iteration: (Period: 7, Amplitude: 45)
</pre></div>
</div>
<img alt="../_images/a51087d10f4e039b8ec241800730fd15c9efbb22337182d5cd4877938afe38fc.png" src="../_images/a51087d10f4e039b8ec241800730fd15c9efbb22337182d5cd4877938afe38fc.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 7 minutes
u1_amplitude = 45 % power
 
=======Iteration Number: 29 =======
Design variable values for this iteration: (Period: 8, Amplitude: 15)
</pre></div>
</div>
<img alt="../_images/866885fa097918c0c7611565b4f9a127b406a86e2085d314806da8a58012a17b.png" src="../_images/866885fa097918c0c7611565b4f9a127b406a86e2085d314806da8a58012a17b.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 8 minutes
u1_amplitude = 15 % power
 
=======Iteration Number: 30 =======
Design variable values for this iteration: (Period: 8, Amplitude: 25)
</pre></div>
</div>
<img alt="../_images/ccfb681f6d581a940d0bd4fb65ef8c02fcd2209f3e411d1de556d87c30599443.png" src="../_images/ccfb681f6d581a940d0bd4fb65ef8c02fcd2209f3e411d1de556d87c30599443.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 8 minutes
u1_amplitude = 25 % power
 
=======Iteration Number: 31 =======
Design variable values for this iteration: (Period: 8, Amplitude: 35)
</pre></div>
</div>
<img alt="../_images/f664a43427c3141caf0256e2c40b8afff2dfdba6e6ef117c86a403cae2100b45.png" src="../_images/f664a43427c3141caf0256e2c40b8afff2dfdba6e6ef117c86a403cae2100b45.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 8 minutes
u1_amplitude = 35 % power
 
=======Iteration Number: 32 =======
Design variable values for this iteration: (Period: 8, Amplitude: 45)
</pre></div>
</div>
<img alt="../_images/7f651f73165df776bb07c66a99c7d7080a859127657d1ba668947fb382a3d9fb.png" src="../_images/7f651f73165df776bb07c66a99c7d7080a859127657d1ba668947fb382a3d9fb.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0413 Watts/degC
Ub = 0.0093 Watts/degC
CpH = 6.0883 Joules/degC
CpS = 0.1731 Joules/degC
u1_period = 8 minutes
u1_amplitude = 45 % power
 
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-and-interpret-sensitivity-analysis-results">
<h2>Visualize and interpret sensitivity analysis results<a class="headerlink" href="#visualize-and-interpret-sensitivity-analysis-results" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Extract criteria from FIM</span>
<span class="k">def</span> <span class="nf">get_FIM_metrics</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
    <span class="n">eigenvalues</span><span class="p">,</span> <span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="n">min_eig</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">)</span>

    <span class="n">A_opt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
    <span class="n">D_opt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
    <span class="n">E_opt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">min_eig</span><span class="p">)</span>
    <span class="n">ME_opt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">A_opt</span><span class="p">,</span> <span class="n">D_opt</span><span class="p">,</span> <span class="n">E_opt</span><span class="p">,</span> <span class="n">ME_opt</span>

<span class="n">FIM_metrics</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">FIM_results</span><span class="p">:</span>
    <span class="n">FIM_metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_FIM_metrics</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

<span class="n">FIM_metrics_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">FIM_metrics</span><span class="p">)</span>

<span class="c1"># Make heat map</span>
<span class="k">def</span> <span class="nf">plot_heatmap</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">colorbar_label</span><span class="p">):</span>
    <span class="c1"># set heatmap x,y ranges</span>
    <span class="n">x_tick_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]))</span>
    <span class="n">y_tick_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]))</span>

    <span class="c1"># optimality-values</span>
    <span class="n">opt_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_tick_labels</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_tick_labels</span><span class="p">))</span>
    
    <span class="c1"># Plot the colormap</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

    <span class="c1"># Plotting options</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;mathtext.default&quot;</span><span class="p">:</span> <span class="s2">&quot;regular&quot;</span><span class="p">}</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

    <span class="c1"># Plotting data</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_tick_labels</span><span class="p">)))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">y_tick_labels</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_tick_labels</span><span class="p">)))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">x_tick_labels</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">opt_vals</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">hot_r</span><span class="p">)</span>
    <span class="n">ba</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
    <span class="n">ba</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">colorbar_label</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

<span class="c1"># X and Y axis labels</span>
<span class="n">x_label</span> <span class="o">=</span> <span class="s2">&quot;Period [min]&quot;</span>
<span class="n">y_label</span> <span class="o">=</span> <span class="s2">&quot;Amplitude [% power]&quot;</span>

<span class="c1"># Draw A-optimality figure</span>
<span class="n">data_A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">FIM_metrics</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">data_A</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_period</span>
<span class="n">data_A</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_amplitude</span>
<span class="n">data_A</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">FIM_metrics_np</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">plot_heatmap</span><span class="p">(</span><span class="n">data_A</span><span class="p">,</span> <span class="s2">&quot;Sine Wave Test: A-optimality&quot;</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="s2">&quot;log10(trace(FIM))&quot;</span><span class="p">)</span>

<span class="c1"># Draw D-optimality figure</span>
<span class="n">data_D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">FIM_metrics</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">data_D</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_period</span>
<span class="n">data_D</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_amplitude</span>
<span class="n">data_D</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">FIM_metrics_np</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">plot_heatmap</span><span class="p">(</span><span class="n">data_D</span><span class="p">,</span> <span class="s2">&quot;Sine Wave Test: D-optimality&quot;</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="s2">&quot;log10(det(FIM))&quot;</span><span class="p">)</span>

<span class="c1"># Draw E-optimality figure</span>
<span class="n">data_E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">FIM_metrics</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">data_E</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_period</span>
<span class="n">data_E</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_amplitude</span>
<span class="n">data_E</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">FIM_metrics_np</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>

<span class="n">plot_heatmap</span><span class="p">(</span><span class="n">data_E</span><span class="p">,</span> <span class="s2">&quot;Sine Wave Test: E-optimality&quot;</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="s2">&quot;log10(min-eig(FIM))&quot;</span><span class="p">)</span>

<span class="c1"># Draw ME-optimality figure</span>
<span class="n">data_ME</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">FIM_metrics</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">data_ME</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_period</span>
<span class="n">data_ME</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_amplitude</span>
<span class="n">data_ME</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">FIM_metrics_np</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span>

<span class="n">plot_heatmap</span><span class="p">(</span><span class="n">data_ME</span><span class="p">,</span> <span class="s2">&quot;Sine Wave Test: ME-optimality&quot;</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="s2">&quot;log10(cond(FIM))&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/60dc23d65e704df92b61f6e77680d1321cc232659b2d6fa1102698b050525dfb.png" src="../_images/60dc23d65e704df92b61f6e77680d1321cc232659b2d6fa1102698b050525dfb.png" />
<img alt="../_images/4b096cc9246ffae3a657db43997dc7783f1aa9337d640908f036be302430e67a.png" src="../_images/4b096cc9246ffae3a657db43997dc7783f1aa9337d640908f036be302430e67a.png" />
<img alt="../_images/cba1a02b69530e82e60a96e39c5721b35582f32f681b23dbb251c26c5447b485.png" src="../_images/cba1a02b69530e82e60a96e39c5721b35582f32f681b23dbb251c26c5447b485.png" />
<img alt="../_images/b2189675e5af0e697d55e8804f207f3c92358586ad724ccba5c63e1f8daffcfb.png" src="../_images/b2189675e5af0e697d55e8804f207f3c92358586ad724ccba5c63e1f8daffcfb.png" />
</div>
</div>
<p>These heatmaps tell us a lot about the mathematical model for the TCLab system.</p>
<p>A-optimality (trace of FIM) is the largest with a long period (8 minutes) and large amplitude (45%). Why does this make sense? The long period means the heating and cooling is more gradual. This gives more information about the dynamics of the system, especially the lag in heat transfer between the two modeled thermal masses. Likewise, the larger amplitude ensures a larger temperature range is explored, which maximizes the ratio of the signal to noise (which is assumed to be i.i.d.)</p>
<p>The D-, E-, and modified-E optimality results are more nuanced. Even with the poorly identifiable parameter, we are still able to see that choosing a period of approximately 3 minutes is best for E- and ME-optimality, where D-optimality sees an optima at about 4-5 minutes of period.</p>
<p>One thing is consistent between all the optimality metrics: larger amplitude (toward 45%) results in more information.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../mbdoe.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Optimal Experiment Design</p>
      </div>
    </a>
    <a class="right-next"
       href="doe_optimize.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Pyomo.DoE: Optimization</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-experimental-data-sine-test">Load experimental data (sine test)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analyze-fim-with-pyomo-doe-at-initial-point-sine-test">Analyze FIM with Pyomo.DoE at initial point (sine test)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reusing-the-experiment-object-used-for-parameter-estimation">Reusing the Experiment object used for parameter estimation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-parameterized-sine-wave-experiment">Define parameterized sine wave experiment</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#perform-sensitivity-analysis-to-sine-wave-frequency-and-period">Perform sensitivity analysis to sine wave frequency and period</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-and-interpret-sensitivity-analysis-results">Visualize and interpret sensitivity analysis results</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Alexander Dowling
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>