

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Pyomo.DoE: Optimization &#8212; Pyomo.DoE Workshop and Tutorials</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/doe_optimize';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Exercise: Pyomo.DoE" href="doe_exercise.html" />
    <link rel="prev" title="Pyomo.DoE: Exploratory Analysis" href="doe_exploratory_analysis.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../Readme.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/PyomoDoE-sm.png" class="logo__image only-light" alt="Pyomo.DoE Workshop and Tutorials - Home"/>
    <script>document.write(`<img src="../_static/PyomoDoE-sm.png" class="logo__image only-dark" alt="Pyomo.DoE Workshop and Tutorials - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../Readme.html">
                    Optimizing Experiments with Pyomo.DoE
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../tclab.html">Modeling Example: TCLab</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="tclab_model.html">TCLab Mathematical Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="numpy_simulation.html">Modeling with Numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyomo_simulation.html">Modeling with Pyomo</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="experiment_abstraction.html">Experiment Abstraction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../regression.html">Parameter Estimation</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="parmest.html">Nonlinear Regression with ParmEst</a></li>
<li class="toctree-l2"><a class="reference internal" href="parmest_exercise.html">Exercise: ParmEst</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../mbdoe.html">Optimal Experiment Design</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="doe_exploratory_analysis.html">Pyomo.DoE: Exploratory Analysis</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Pyomo.DoE: Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="doe_exercise.html">Exercise: Pyomo.DoE</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../exercises.html">Exercise Solutions</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../exercise_solutions/parmest_exercise.html">Exercise: ParmEst</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exercise_solutions/doe_exercise.html">Exercise: Pyomo.DoE</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/dowlinglab/pyomo-doe/blob/main/notebooks/doe_optimize.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/dowlinglab/pyomo-doe" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/dowlinglab/pyomo-doe/issues/new?title=Issue%20on%20page%20%2Fnotebooks/doe_optimize.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/doe_optimize.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Pyomo.DoE: Optimization</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-experimental-data-sine-test">Load experimental data (sine test)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-fim-at-initial-point-sine-test">Calculate FIM at initial point (sine test)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimize-next-experiment-d-optimality">Optimize next experiment (D-optimality)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimize-next-experiment-a-optimality">Optimize next experiment (A-optimality)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sensitivity-analysis">Sensitivity Analysis</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="pyomo-doe-optimization">
<h1>Pyomo.DoE: Optimization<a class="headerlink" href="#pyomo-doe-optimization" title="Permalink to this heading">#</a></h1>
<p>Our <a class="reference internal" href="doe_exploratory_analysis.html"><span class="doc std std-doc">earlier exploratory analysis</span></a> showed the sine wave experiment alone is rank deficient. What if instead of optimizing the sine wave parameters <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(p\)</span>, we directly optimize <span class="math notranslate nohighlight">\(u(t)\)</span>. In other words, we will formulate model-based design of experiments as an <a class="reference internal" href="pyomo_simulation.html"><span class="doc std std-doc">optimal control problem</span></a>.</p>
<p>Maximize a scalar-valued function <span class="math notranslate nohighlight">\(\psi(\cdot)\)</span> of the Fisher information matrix <span class="math notranslate nohighlight">\(\mathbf{M}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\max_{u} \quad &amp; \psi(\mathbf{M}(u) + \mathbf{M}_0) \\
\mathrm{s.t.} \quad &amp; C_p^H \frac{dT_H}{dt} = U_a (T_{amb} - T_H) + U_b (T_S - T_H) + \alpha P u(t)\\
&amp; C_p^S \frac{dT_S}{dt} = U_b (T_H - T_S)  \\
&amp; 0\% \leq u(t) \leq 100 \% \\
&amp; T_H(t_0) = T_{amb} \\
&amp; T_S(t_0) = T_{amb}
\end{align*}
\end{split}\]</div>
<p><code class="docutils literal notranslate"><span class="pre">Pyomo.DoE</span></code> automatically formulates, initializes, and solves this optimization problem for <span class="math notranslate nohighlight">\(\psi(\cdot) = \log_{10}(\mathrm{trace}(\cdot))\)</span>, i.e., A-optimality, and <span class="math notranslate nohighlight">\(\psi(\cdot) = \log_{10}(\mathrm{det}(\cdot))\)</span>, i.e., D-optimality.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>

<span class="c1"># If running on Google Colab, install Pyomo and Ipopt via IDAES</span>
<span class="n">on_colab</span> <span class="o">=</span> <span class="s2">&quot;google.colab&quot;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span>
<span class="k">if</span> <span class="n">on_colab</span><span class="p">:</span>
    <span class="o">!</span>wget<span class="w"> </span><span class="s2">&quot;https://raw.githubusercontent.com/dowlinglab/pyomo-doe/main/notebooks/tclab_pyomo.py&quot;</span>

<span class="c1"># import TCLab model, simulation, and data analysis functions</span>
<span class="kn">from</span> <span class="nn">tclab_pyomo</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">TC_Lab_data</span><span class="p">,</span>
    <span class="n">TC_Lab_experiment</span><span class="p">,</span>
    <span class="n">extract_results</span><span class="p">,</span>
    <span class="n">extract_plot_results</span><span class="p">,</span>
    <span class="n">results_summary</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># set default number of states in the TCLab model</span>
<span class="n">number_tclab_states</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<section id="load-experimental-data-sine-test">
<h2>Load experimental data (sine test)<a class="headerlink" href="#load-experimental-data-sine-test" title="Permalink to this heading">#</a></h2>
<p>We will load the sine test data to serve as an initial point. Recall our create model function will use supplied data to initialize the Pyomo model. Carefully initialization is often required for optimization of large-scale dynamic systems.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="k">if</span> <span class="n">on_colab</span><span class="p">:</span>
    <span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/dowlinglab/pyomo-doe/main/data/tclab_sine_test_5min_period.csv&quot;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">file</span> <span class="o">=</span> <span class="s1">&#39;../data/tclab_sine_test_5min_period.csv&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
      <th>T1</th>
      <th>T2</th>
      <th>Q1</th>
      <th>Q2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.00</td>
      <td>22.2</td>
      <td>22.2</td>
      <td>50</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.01</td>
      <td>22.2</td>
      <td>22.2</td>
      <td>51</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.01</td>
      <td>22.2</td>
      <td>22.2</td>
      <td>52</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.00</td>
      <td>22.2</td>
      <td>22.2</td>
      <td>53</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.01</td>
      <td>22.2</td>
      <td>22.2</td>
      <td>54</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>For completeness, we will visualize the data again.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="s1">&#39;T2&#39;</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Temperature (°C)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fbf2644f6f803238293870aec0099c1bb77225c820bcc42071fca6f36db6f2e6.png" src="../_images/fbf2644f6f803238293870aec0099c1bb77225c820bcc42071fca6f36db6f2e6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Heater Power (%)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ab15113c9ac37b32ee9820b6e12aa73656cb2294c8fbe7117425cffc67afcbcb.png" src="../_images/ab15113c9ac37b32ee9820b6e12aa73656cb2294c8fbe7117425cffc67afcbcb.png" />
</div>
</div>
<p>And then we will store the data in an instance of our <code class="docutils literal notranslate"><span class="pre">TC_Lab_data</span></code> dataclass.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Here, we will induce a step size of 6 seconds, as to not give too many </span>
<span class="c1"># degrees of freedom for experimental design.</span>
<span class="n">skip</span> <span class="o">=</span> <span class="mi">6</span>

<span class="c1"># Create the data object considering the new control points every 6 seconds</span>
<span class="n">tc_data</span> <span class="o">=</span> <span class="n">TC_Lab_data</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Sine Wave Test for Heater 1&quot;</span><span class="p">,</span>
    <span class="n">time</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[::</span><span class="n">skip</span><span class="p">],</span>
    <span class="n">T1</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;T1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[::</span><span class="n">skip</span><span class="p">],</span>
    <span class="n">u1</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Q1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[::</span><span class="n">skip</span><span class="p">],</span>
    <span class="n">P1</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
    <span class="n">TS1_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">T2</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;T2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[::</span><span class="n">skip</span><span class="p">],</span>
    <span class="n">u2</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Q2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[::</span><span class="n">skip</span><span class="p">],</span>
    <span class="n">P2</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
    <span class="n">TS2_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">Tamb</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;T1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-fim-at-initial-point-sine-test">
<h2>Calculate FIM at initial point (sine test)<a class="headerlink" href="#calculate-fim-at-initial-point-sine-test" title="Permalink to this heading">#</a></h2>
<p>We will start computing the FIM of the sine test experiment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load Pyomo.DoE class</span>
<span class="kn">from</span> <span class="nn">pyomo.contrib.doe</span> <span class="kn">import</span> <span class="n">DesignOfExperiments</span>

<span class="kn">from</span> <span class="nn">pyomo.environ</span> <span class="kn">import</span> <span class="n">SolverFactory</span>

<span class="c1"># Copied from previous notebook</span>
<span class="n">theta_values</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Ua&#39;</span><span class="p">:</span> <span class="mf">0.0417051733576387</span><span class="p">,</span>
    <span class="s1">&#39;Ub&#39;</span><span class="p">:</span> <span class="mf">0.009440714239773074</span><span class="p">,</span>
    <span class="s1">&#39;inv_CpH&#39;</span><span class="p">:</span> <span class="mf">0.1659093525658045</span><span class="p">,</span>
    <span class="s1">&#39;inv_CpS&#39;</span><span class="p">:</span> <span class="mf">5.8357556063605465</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create experiment object for design of experiments</span>
<span class="n">doe_experiment</span> <span class="o">=</span> <span class="n">TC_Lab_experiment</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">tc_data</span><span class="p">,</span> <span class="n">theta_initial</span><span class="o">=</span><span class="n">theta_values</span><span class="p">,</span> <span class="n">number_of_states</span><span class="o">=</span><span class="n">number_tclab_states</span><span class="p">)</span>

<span class="c1"># Create the design of experiments object using our experiment instance from above</span>
<span class="n">TC_Lab_DoE</span> <span class="o">=</span> <span class="n">DesignOfExperiments</span><span class="p">(</span><span class="n">experiment</span><span class="o">=</span><span class="n">doe_experiment</span><span class="p">,</span> 
                                 <span class="n">step</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
                                 <span class="n">scale_constant_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                 <span class="n">scale_nominal_param_value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                 <span class="n">tee</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>

<span class="n">FIM</span> <span class="o">=</span> <span class="n">TC_Lab_DoE</span><span class="o">.</span><span class="n">compute_FIM</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sequential&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we will look at the eigendecomposition using the helper function <code class="docutils literal notranslate"><span class="pre">results_summary</span></code> defined in <code class="docutils literal notranslate"><span class="pre">tclab_pyomo.py</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_summary</span><span class="p">(</span><span class="n">FIM</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>======Results Summary======
Four design criteria log10() value:
A-optimality: 5.773228885932493
D-optimality: 12.308607163946094
E-optimality: -1.793074158088514
Modified E-optimality: 7.514721752736364

FIM:
 [[517225.40941304   1360.01262476 -66404.72541298  -1002.47319402]
 [  1360.01262476   5004.3737258   12379.2662576    5238.40389773]
 [-66404.72541298  12379.2662576   65481.16908635  14190.01468139]
 [ -1002.47319402   5238.40389773  14190.01468139   5526.94375493]]

eigenvalues:
 [5.26802218e+05 6.26035823e+04 3.83207978e+03 1.61037063e-02]

eigenvectors:
 [[-9.89752804e-01 -1.35949591e-01  4.36702406e-02 -7.52086327e-05]
 [ 8.63262440e-04 -2.26164575e-01 -6.85698047e-01 -6.91857665e-01]
 [ 1.42671125e-01 -9.31600001e-01  3.33329462e-01 -2.56487437e-02]
 [ 5.79584008e-03 -2.49977462e-01 -6.45602485e-01  7.21578207e-01]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="optimize-next-experiment-d-optimality">
<h2>Optimize next experiment (D-optimality)<a class="headerlink" href="#optimize-next-experiment-d-optimality" title="Permalink to this heading">#</a></h2>
<p>We are now ready to solve the optimization problem! Notice we create a new <code class="docutils literal notranslate"><span class="pre">DesignOfExperiments</span></code> object and specify the <code class="docutils literal notranslate"><span class="pre">prior_FIM</span></code> as result for the sine wave test. Thus we are decided what is the next best experiment to conduct. We already completed to sine test; we should use the data!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create experiment object for design of experiments</span>
<span class="n">doe_experiment</span> <span class="o">=</span> <span class="n">TC_Lab_experiment</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">tc_data</span><span class="p">,</span> <span class="n">theta_initial</span><span class="o">=</span><span class="n">theta_values</span><span class="p">,</span> <span class="n">number_of_states</span><span class="o">=</span><span class="n">number_tclab_states</span><span class="p">)</span>

<span class="c1"># Create the design of experiments object using our experiment instance from above</span>
<span class="n">TC_Lab_DoE_D</span> <span class="o">=</span> <span class="n">DesignOfExperiments</span><span class="p">(</span><span class="n">experiment</span><span class="o">=</span><span class="n">doe_experiment</span><span class="p">,</span> 
                                 <span class="n">step</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
                                 <span class="n">scale_constant_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                 <span class="n">scale_nominal_param_value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                 <span class="n">objective_option</span><span class="o">=</span><span class="s2">&quot;determinant&quot;</span><span class="p">,</span>  <span class="c1"># Now we specify a type of objective, D-opt = &quot;determinant&quot;</span>
                                 <span class="n">prior_FIM</span><span class="o">=</span><span class="n">FIM</span><span class="p">,</span>  <span class="c1"># We use the prior information from the existing experiment!</span>
                                 <span class="n">tee</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>

<span class="n">TC_Lab_DoE_D</span><span class="o">.</span><span class="n">run_doe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1800
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      602
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      300
                     variables with only upper bounds:        0
Total number of equality constraints.................:      602
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 3.76e-01 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1  0.0000000e+00 3.55e-15 1.04e-02  -1.0 2.21e+00    -  9.11e-01 1.00e+00h  1

Number of Iterations....: 1

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   0.0000000000000000e+00    0.0000000000000000e+00
Constraint violation....:   3.5527136788005009e-15    3.5527136788005009e-15
Complementarity.........:   0.0000000000000000e+00    0.0000000000000000e+00
Overall NLP error.......:   3.5527136788005009e-15    3.5527136788005009e-15


Number of objective function evaluations             = 2
Number of objective gradient evaluations             = 2
Number of equality constraint evaluations            = 2
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 2
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 1
Total CPU secs in IPOPT (w/o function evaluations)   =      0.002
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1951
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      753
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      451
                     variables with only upper bounds:        0
Total number of equality constraints.................:      602
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 3.41e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (18093)
   1  0.0000000e+00 3.55e-15 3.98e-04  -1.0 3.89e-01    -  9.78e-01 1.00e+00f  1
   2  0.0000000e+00 3.55e-15 1.33e-03  -1.0 9.68e+00    -  9.40e-01 1.00e+00f  1
   3  0.0000000e+00 3.55e-15 5.56e-04  -1.7 3.29e+01    -  8.81e-01 1.00e+00f  1
   4  0.0000000e+00 3.55e-15 6.40e-18  -2.5 3.16e+00    -  1.00e+00 1.00e+00f  1
   5  0.0000000e+00 3.55e-15 5.32e-19  -3.8 3.68e+00    -  1.00e+00 1.00e+00f  1
   6  0.0000000e+00 3.55e-15 7.31e-21  -5.7 4.29e-01    -  1.00e+00 1.00e+00f  1
   7  0.0000000e+00 3.76e-15 3.85e-22  -8.6 6.23e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 7

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   3.8463898483715787e-22    3.8463898483715787e-22
Constraint violation....:   3.7608804959177178e-15    3.7608804959177178e-15
Complementarity.........:   5.3526636694796017e-09    5.3526636694796017e-09
Overall NLP error.......:   5.3526636694796017e-09    5.3526636694796017e-09


Number of objective function evaluations             = 8
Number of objective gradient evaluations             = 8
Number of equality constraint evaluations            = 8
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 8
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 7
Total CPU secs in IPOPT (w/o function evaluations)   =      0.006
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1951
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      753
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      451
                     variables with only upper bounds:        0
Total number of equality constraints.................:      602
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 3.41e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (18093)
   1  0.0000000e+00 3.55e-15 6.51e-04  -1.0 5.04e-01    -  9.72e-01 1.00e+00f  1
   2  0.0000000e+00 3.55e-15 6.27e-04  -1.0 9.47e+00    -  9.75e-01 1.00e+00f  1
   3  0.0000000e+00 3.55e-15 9.84e-05  -1.7 6.36e+00    -  9.69e-01 1.00e+00f  1
   4  0.0000000e+00 3.55e-15 3.43e-05  -2.5 1.28e+01    -  9.59e-01 1.00e+00f  1
   5  0.0000000e+00 3.55e-15 2.57e-19  -3.8 1.40e+00    -  1.00e+00 1.00e+00f  1
   6  0.0000000e+00 3.55e-15 2.83e-20  -5.7 5.96e-01    -  1.00e+00 1.00e+00f  1
   7  0.0000000e+00 3.55e-15 1.41e-22  -8.6 4.56e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 7

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   1.4082749928715296e-22    1.4082749928715296e-22
Constraint violation....:   3.5527136788005009e-15    3.5527136788005009e-15
Complementarity.........:   4.7026222762342791e-09    4.7026222762342791e-09
Overall NLP error.......:   4.7026222762342791e-09    4.7026222762342791e-09


Number of objective function evaluations             = 8
Number of objective gradient evaluations             = 8
Number of equality constraint evaluations            = 8
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 8
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 7
Total CPU secs in IPOPT (w/o function evaluations)   =      0.016
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1951
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      753
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      451
                     variables with only upper bounds:        0
Total number of equality constraints.................:      602
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 3.43e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (18093)
   1  0.0000000e+00 3.55e-15 4.62e-05  -1.0 1.03e-01    -  9.89e-01 1.00e+00f  1
   2  0.0000000e+00 3.65e-15 2.43e-17  -1.0 9.93e+00    -  1.00e+00 1.00e+00f  1
   3  0.0000000e+00 5.33e-15 1.82e-17  -2.5 2.66e+00    -  1.00e+00 1.00e+00f  1
   4  0.0000000e+00 3.55e-15 1.74e-08  -3.8 2.04e+00    -  1.00e+00 1.00e+00f  1
   5  0.0000000e+00 3.55e-15 1.94e-08  -5.7 1.85e+00    -  9.96e-01 1.00e+00f  1
   6  0.0000000e+00 3.55e-15 4.73e-14  -8.6 3.85e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 6

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   4.7326499001393032e-14    4.7326499001393032e-14
Constraint violation....:   3.5527136788005009e-15    3.5527136788005009e-15
Complementarity.........:   4.8319883555020095e-09    4.8319883555020095e-09
Overall NLP error.......:   4.8319883555020095e-09    4.8319883555020095e-09


Number of objective function evaluations             = 7
Number of objective gradient evaluations             = 7
Number of equality constraint evaluations            = 7
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 7
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 6
Total CPU secs in IPOPT (w/o function evaluations)   =      0.016
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1951
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      753
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      451
                     variables with only upper bounds:        0
Total number of equality constraints.................:      602
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 3.43e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (18093)
   1  0.0000000e+00 3.55e-15 3.50e-05  -1.0 1.00e-01    -  9.90e-01 1.00e+00f  1
   2  0.0000000e+00 3.80e-15 2.43e-17  -1.0 9.94e+00    -  1.00e+00 1.00e+00f  1
   3  0.0000000e+00 3.55e-15 1.77e-17  -2.5 3.12e+00    -  1.00e+00 1.00e+00f  1
   4  0.0000000e+00 3.55e-15 2.57e-07  -3.8 1.95e+00    -  9.97e-01 1.00e+00f  1
   5  0.0000000e+00 3.77e-15 1.36e-08  -5.7 1.65e+00    -  9.97e-01 1.00e+00f  1
   6  0.0000000e+00 3.55e-15 1.44e-12  -8.6 3.95e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 6

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   1.4351761207895442e-12    1.4351761207895442e-12
Constraint violation....:   3.5527136788005009e-15    3.5527136788005009e-15
Complementarity.........:   4.9764826151987226e-09    4.9764826151987226e-09
Overall NLP error.......:   4.9764826151987226e-09    4.9764826151987226e-09


Number of objective function evaluations             = 7
Number of objective gradient evaluations             = 7
Number of equality constraint evaluations            = 7
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 7
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 6
Total CPU secs in IPOPT (w/o function evaluations)   =      0.015
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1951
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      753
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      451
                     variables with only upper bounds:        0
Total number of equality constraints.................:      602
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 3.69e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (18093)
   1  0.0000000e+00 3.55e-15 2.03e-04  -1.0 2.05e-01    -  9.83e-01 1.00e+00f  1
   2  0.0000000e+00 3.55e-15 8.33e-17  -1.0 9.63e+00    -  1.00e+00 1.00e+00f  1
   3  0.0000000e+00 3.55e-15 1.37e-17  -1.7 1.29e+01    -  1.00e+00 1.00e+00f  1
   4  0.0000000e+00 3.55e-15 3.52e-18  -2.5 8.06e+00    -  1.00e+00 1.00e+00f  1
   5  0.0000000e+00 3.55e-15 4.40e-19  -3.8 2.21e+00    -  1.00e+00 1.00e+00f  1
   6  0.0000000e+00 3.55e-15 1.91e-20  -5.7 4.75e-01    -  1.00e+00 1.00e+00f  1
   7  0.0000000e+00 3.55e-15 2.77e-22  -8.6 4.85e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 7

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   2.7710550520526427e-22    2.7710550520526427e-22
Constraint violation....:   3.5527136788005009e-15    3.5527136788005009e-15
Complementarity.........:   4.8792798895046795e-09    4.8792798895046795e-09
Overall NLP error.......:   4.8792798895046795e-09    4.8792798895046795e-09


Number of objective function evaluations             = 8
Number of objective gradient evaluations             = 8
Number of equality constraint evaluations            = 8
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 8
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 7
Total CPU secs in IPOPT (w/o function evaluations)   =      0.016
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1951
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      753
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      451
                     variables with only upper bounds:        0
Total number of equality constraints.................:      602
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 3.69e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (18093)
   1  0.0000000e+00 3.55e-15 1.71e-04  -1.0 2.41e-01    -  9.85e-01 1.00e+00f  1
   2  0.0000000e+00 3.55e-15 5.53e-04  -1.0 5.81e+00    -  9.54e-01 1.00e+00f  1
   3  0.0000000e+00 3.55e-15 4.71e-04  -1.7 4.04e+01    -  8.75e-01 1.00e+00f  1
   4  0.0000000e+00 3.55e-15 5.31e-18  -2.5 3.18e+00    -  1.00e+00 1.00e+00f  1
   5  0.0000000e+00 3.55e-15 5.42e-19  -3.8 3.31e+00    -  1.00e+00 1.00e+00f  1
   6  0.0000000e+00 3.55e-15 9.85e-21  -5.7 3.88e-01    -  1.00e+00 1.00e+00f  1
   7  0.0000000e+00 2.76e-15 2.34e-22  -8.6 5.49e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 7

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   2.3409211335250683e-22    2.3409211335250683e-22
Constraint violation....:   2.7616797737550769e-15    2.7616797737550769e-15
Complementarity.........:   5.1165889275871179e-09    5.1165889275871179e-09
Overall NLP error.......:   5.1165889275871179e-09    5.1165889275871179e-09


Number of objective function evaluations             = 8
Number of objective gradient evaluations             = 8
Number of equality constraint evaluations            = 8
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 8
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 7
Total CPU secs in IPOPT (w/o function evaluations)   =      0.016
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1951
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      753
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      451
                     variables with only upper bounds:        0
Total number of equality constraints.................:      602
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 3.43e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (18093)
   1  0.0000000e+00 3.55e-15 4.84e-05  -1.0 1.05e-01    -  9.89e-01 1.00e+00f  1
   2  0.0000000e+00 3.55e-15 2.08e-17  -1.0 9.92e+00    -  1.00e+00 1.00e+00f  1
   3  0.0000000e+00 3.55e-15 1.47e-17  -2.5 2.55e+00    -  1.00e+00 1.00e+00f  1
   4  0.0000000e+00 3.55e-15 1.76e-19  -3.8 2.09e+00    -  1.00e+00 1.00e+00f  1
   5  0.0000000e+00 3.55e-15 1.74e-08  -5.7 1.71e+00    -  9.96e-01 1.00e+00f  1
   6  0.0000000e+00 3.55e-15 2.26e-13  -8.6 3.95e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 6

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   2.2587528186040976e-13    2.2587528186040976e-13
Constraint violation....:   3.5527136788005009e-15    3.5527136788005009e-15
Complementarity.........:   4.8736431340332237e-09    4.8736431340332237e-09
Overall NLP error.......:   4.8736431340332237e-09    4.8736431340332237e-09


Number of objective function evaluations             = 7
Number of objective gradient evaluations             = 7
Number of equality constraint evaluations            = 7
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 7
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 6
Total CPU secs in IPOPT (w/o function evaluations)   =      0.015
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1951
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      753
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      451
                     variables with only upper bounds:        0
Total number of equality constraints.................:      602
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 3.43e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (18093)
   1  0.0000000e+00 3.55e-15 3.51e-05  -1.0 1.00e-01    -  9.90e-01 1.00e+00f  1
   2  0.0000000e+00 3.55e-15 2.08e-17  -1.0 9.93e+00    -  1.00e+00 1.00e+00f  1
   3  0.0000000e+00 3.55e-15 1.31e-17  -2.5 3.29e+00    -  1.00e+00 1.00e+00f  1
   4  0.0000000e+00 3.55e-15 3.09e-07  -3.8 1.98e+00    -  9.96e-01 1.00e+00f  1
   5  0.0000000e+00 3.55e-15 1.30e-08  -5.7 1.60e+00    -  9.97e-01 1.00e+00f  1
   6  0.0000000e+00 3.55e-15 1.66e-12  -8.6 3.95e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 6

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   1.6640804565696806e-12    1.6640804565696806e-12
Constraint violation....:   3.5527136788005009e-15    3.5527136788005009e-15
Complementarity.........:   4.9986864279830130e-09    4.9986864279830130e-09
Overall NLP error.......:   4.9986864279830130e-09    4.9986864279830130e-09


Number of objective function evaluations             = 7
Number of objective gradient evaluations             = 7
Number of equality constraint evaluations            = 7
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 7
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 6
Total CPU secs in IPOPT (w/o function evaluations)   =      0.000
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:    20744
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:     1510

Total number of variables............................:     6487
                     variables with only lower bounds:        0
                variables with lower and upper bounds:     3457
                     variables with only upper bounds:        0
Total number of equality constraints.................:     6487
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 5.54e+01 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (330773)
   1  0.0000000e+00 4.31e+05 9.28e-01  -1.0 3.58e+01    -  4.23e-01 1.00e+00h  1
   2  0.0000000e+00 1.16e-10 5.50e-03  -1.0 4.31e+05    -  9.92e-01 1.00e+00h  1

Number of Iterations....: 2

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   0.0000000000000000e+00    0.0000000000000000e+00
Constraint violation....:   1.1641532182693481e-10    1.1641532182693481e-10
Complementarity.........:   0.0000000000000000e+00    0.0000000000000000e+00
Overall NLP error.......:   1.1641532182693481e-10    1.1641532182693481e-10


Number of objective function evaluations             = 3
Number of objective gradient evaluations             = 3
Number of equality constraint evaluations            = 3
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 3
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 2
Total CPU secs in IPOPT (w/o function evaluations)   =      0.104
Total CPU secs in NLP function evaluations           =      0.001

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:    21992
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:     1530

Reallocating memory for MA57: lfact (395831)
Total number of variables............................:     6648
                     variables with only lower bounds:        4
                variables with lower and upper bounds:     3608
                     variables with only upper bounds:        0
Total number of equality constraints.................:     6497
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0 -1.3596140e+01 1.16e-10 3.35e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1 -1.3594800e+01 7.48e-02 9.78e-03  -1.0 3.50e+02    -  9.90e-01 1.00e+00f  1
   2 -1.3478717e+01 5.58e+02 2.19e-02  -1.0 3.02e+04    -  1.00e+00 1.00e+00f  1
   3 -1.3012587e+01 7.38e+02 4.40e-01  -1.0 1.41e+05    -  1.00e+00 1.00e+00F  1
   4 -1.3091923e+01 8.43e+01 1.23e-02  -1.0 9.36e+03    -  1.00e+00 1.00e+00h  1
   5 -1.3090005e+01 1.35e-02 9.82e-05  -1.0 1.38e+02    -  1.00e+00 1.00e+00h  1
   6 -1.3096572e+01 4.71e+00 1.77e-03  -2.5 1.90e+03    -  1.00e+00 1.00e+00h  1
   7 -1.3354298e+01 6.94e+03 2.38e-01  -2.5 6.42e+04    -  1.00e+00 1.00e+00h  1
   8 -1.3336877e+01 1.63e+02 1.03e-02  -2.5 1.72e+03    -  1.00e+00 1.00e+00h  1
   9 -1.3335937e+01 2.25e+00 2.84e-05  -2.5 3.64e+01    -  1.00e+00 1.00e+00h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  10 -1.3335958e+01 4.89e-05 2.94e-08  -2.5 1.23e+00    -  1.00e+00 1.00e+00h  1
  11 -1.3554642e+01 4.41e+03 1.34e-01  -3.8 6.22e+04    -  8.17e-01 1.00e+00f  1
  12 -1.3537124e+01 6.08e+01 3.08e-03  -3.8 2.39e+00  -4.0 1.00e+00 1.00e+00h  1
  13 -1.3537055e+01 1.13e-01 2.83e-05  -3.8 6.18e-01  -4.5 1.00e+00 1.00e+00h  1
  14 -1.3953722e+01 1.02e+04 3.01e-01  -3.8 3.28e+05    -  1.00e+00 6.55e-01F  1
  15 -1.3934900e+01 5.53e+01 5.96e-03  -3.8 9.08e+00  -5.0 1.00e+00 1.00e+00h  1
  16 -1.3934975e+01 5.19e+00 6.59e-05  -3.8 2.31e+00  -5.4 1.00e+00 1.00e+00h  1
  17 -1.3935744e+01 2.89e+01 3.38e-05  -3.8 7.27e+00  -5.9 1.00e+00 1.00e+00h  1
  18 -1.3938862e+01 2.27e+02 2.38e-04  -3.8 2.94e+01  -6.4 1.00e+00 1.00e+00h  1
  19 -1.3950788e+01 3.53e+03 3.78e-03  -3.8 1.14e+02  -6.9 1.00e+00 1.00e+00h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  20 -1.3974227e+01 5.77e+02 2.11e-03  -3.8 2.32e+02  -7.3 1.00e+00 1.00e+00h  1
  21 -1.4153177e+01 5.16e+03 4.44e-02  -3.8 1.62e+05    -  4.54e-01 3.79e-01h  1
  22 -1.4388656e+01 3.11e+03 5.58e-02  -3.8 7.86e+04    -  1.00e+00 9.88e-01h  1
  23 -1.4333584e+01 4.91e+02 5.18e-03  -3.8 1.27e+04    -  1.00e+00 1.00e+00h  1
  24 -1.4342298e+01 5.26e+02 3.99e-04  -3.8 4.26e+03    -  9.44e-01 9.31e-01h  1
  25 -1.4341697e+01 1.11e+01 2.79e-05  -3.8 2.82e+01  -7.8 1.00e+00 1.00e+00h  1
  26 -1.4343016e+01 1.29e+00 4.58e-06  -3.8 2.22e+02    -  1.00e+00 1.00e+00h  1
  27 -1.4343013e+01 4.11e-02 3.03e-08  -3.8 2.07e+01    -  1.00e+00 1.00e+00h  1
  28 -1.4343013e+01 3.47e-05 1.50e-09  -3.8 6.31e-01    -  1.00e+00 1.00e+00h  1
  29 -1.4449436e+01 2.45e+03 7.92e-03  -5.7 1.66e+05    -  4.00e-01 4.95e-01f  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  30 -1.4487521e+01 2.12e+03 6.34e-03  -5.7 1.19e+05    -  2.72e-01 3.01e-01h  1
  31 -1.4495022e+01 1.94e+03 5.79e-03  -5.7 7.35e+04    -  3.65e-01 9.17e-02h  1
  32 -1.4498859e+01 8.40e+01 1.49e-04  -5.7 1.22e+02  -7.4 6.92e-01 1.00e+00h  1
  33 -1.4503714e+01 8.38e+01 3.12e-04  -5.7 1.76e+05    -  1.10e-01 2.67e-02h  1
  34 -1.4515382e+01 8.74e+01 2.95e-04  -5.7 1.37e+05    -  1.15e-01 7.83e-02h  1
  35 -1.4519265e+01 1.10e+02 2.58e-04  -5.7 1.92e+05    -  1.04e-01 3.15e-02h  1
  36 -1.4525395e+01 1.04e+02 2.55e-04  -5.7 7.36e+04    -  1.28e-01 7.34e-02h  1
  37 -1.4532462e+01 9.72e+01 2.37e-04  -5.7 6.75e+04    -  1.49e-01 1.12e-01h  1
  38 -1.4538538e+01 1.31e+02 2.03e-04  -5.7 9.53e+04    -  1.14e-01 1.30e-01h  1
  39 -1.4540567e+01 1.47e+02 1.79e-04  -5.7 1.60e+05    -  1.24e-01 4.76e-02h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  40 -1.4541394e+01 1.44e+02 1.91e-04  -5.7 5.19e+04    -  7.57e-02 2.85e-02h  1
  41 -1.4543822e+01 1.32e+02 2.39e-04  -5.7 2.09e+04    -  3.29e-01 9.72e-02h  1
  42 -1.4548414e+01 9.85e+01 4.46e-04  -5.7 2.42e+03    -  8.26e-01 2.61e-01h  1
  43 -1.4552233e+01 4.34e+00 2.83e-04  -5.7 2.80e+02  -7.9 4.00e-01 1.00e+00h  1
  44 -1.4553895e+01 4.38e+00 2.08e-04  -5.7 4.02e+02  -8.3 1.00e+00 3.44e-01h  1
  45 -1.4555327e+01 3.39e+00 2.19e-04  -5.7 5.22e+02  -8.8 6.01e-01 3.27e-01f  1
  46 -1.4558214e+01 1.53e+00 8.13e-06  -5.7 4.82e+02  -9.3 1.00e+00 1.00e+00h  1
  47 -1.4558149e+01 5.09e+00 2.28e-04  -5.7 8.52e+02  -9.8 1.51e-01 4.75e-01H  1
  48 -1.4557901e+01 4.77e+00 3.70e-06  -5.7 2.38e+02 -10.3 1.00e+00 1.00e+00f  1
  49 -1.4558056e+01 3.28e+00 1.66e-05  -5.7 5.46e+02 -10.7 6.02e-01 6.92e-01H  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  50 -1.4558138e+01 1.17e+01 2.03e-04  -5.7 1.49e+04 -11.2 7.25e-01 3.25e-01h  1
  51 -1.4558141e+01 1.15e+01 8.01e-05  -5.7 2.88e+02  -9.9 1.00e+00 1.81e-02h  1
  52 -1.4558171e+01 2.35e+00 9.10e-04  -5.7 2.39e+03    -  4.09e-01 1.00e+00h  1
  53 -1.4558281e+01 3.87e-01 1.05e-06  -5.7 8.97e+02 -10.4 1.00e+00 1.00e+00h  1
  54 -1.4558432e+01 6.58e+00 2.22e-05  -5.7 3.78e+03 -10.8 9.53e-01 9.88e-01h  1
  55 -1.4558443e+01 1.78e-02 1.88e-07  -5.7 1.17e+00  -6.8 1.00e+00 1.00e+00h  1
  56 -1.4558458e+01 8.45e-02 1.23e-07  -5.7 2.30e+00  -7.3 1.00e+00 1.00e+00h  1
  57 -1.4558462e+01 1.08e-01 6.33e-05  -5.7 9.97e+00  -7.7 1.00e+00 1.50e-01h  2
  58 -1.4558491e+01 3.31e-02 4.07e-08  -5.7 6.85e+00  -8.2 1.00e+00 1.00e+00h  1
  59 -1.4558496e+01 3.92e-03 4.25e-08  -5.7 2.15e+01  -8.7 1.00e+00 1.00e+00h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  60 -1.4558500e+01 3.31e-03 4.30e-08  -5.7 6.51e+01  -9.2 1.00e+00 1.00e+00h  1
  61 -1.4558511e+01 2.78e-02 6.92e-08  -5.7 1.99e+02  -9.7 1.00e+00 1.00e+00h  1
  62 -1.4558547e+01 2.72e-01 6.76e-07  -5.7 6.28e+02 -10.1 1.00e+00 1.00e+00h  1
  63 -1.4558583e+01 4.54e-01 4.84e-05  -5.7 2.47e+04    -  1.44e-01 2.28e-02h  2
  64 -1.4558618e+01 3.21e-01 1.88e-04  -5.7 1.31e+03    -  1.00e+00 4.40e-01h  1
  65 -1.4558616e+01 6.26e-02 1.28e-07  -5.7 4.15e+02    -  1.00e+00 1.00e+00h  1
  66 -1.4558617e+01 2.12e-06 1.87e-11  -5.7 5.78e-01    -  1.00e+00 1.00e+00h  1
  67 -1.4560214e+01 3.61e-01 1.17e-05  -8.6 2.63e+02    -  7.17e-01 8.18e-01h  1
  68 -1.4560565e+01 3.94e-02 2.70e-07  -8.6 2.22e+02    -  9.95e-01 9.80e-01h  1
  69 -1.4560572e+01 1.32e-04 3.98e-10  -8.6 1.88e+01    -  1.00e+00 1.00e+00h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  70 -1.4560572e+01 2.33e-10 7.27e-14  -8.6 1.28e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 70

                                   (scaled)                 (unscaled)
Objective...............:  -1.4560571732274660e+01   -1.4560571732274660e+01
Dual infeasibility......:   7.2676893022525018e-14    7.2676893022525018e-14
Constraint violation....:   8.1238801465175856e-11    2.3283064365386963e-10
Complementarity.........:   2.5059035653642695e-09    2.5059035653642695e-09
Overall NLP error.......:   2.5059035653642695e-09    2.5059035653642695e-09


Number of objective function evaluations             = 80
Number of objective gradient evaluations             = 71
Number of equality constraint evaluations            = 82
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 71
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 70
Total CPU secs in IPOPT (w/o function evaluations)   =      2.831
Total CPU secs in NLP function evaluations           =      0.032

EXIT: Optimal Solution Found.
</pre></div>
</div>
</div>
</div>
<p>Now let’s visualize the optimal experiment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dopt_pyomo_doe_results</span> <span class="o">=</span> <span class="n">extract_plot_results</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">TC_Lab_DoE_D</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">scenario_blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/224068907e434207263d4379b051dd793420fb08fbfc279fe62f2636a7160318.png" src="../_images/224068907e434207263d4379b051dd793420fb08fbfc279fe62f2636a7160318.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0421 Watts/degC
Ub = 0.0094 Watts/degC
CpH = 6.0274 Joules/degC
CpS = 0.1714 Joules/degC
 
</pre></div>
</div>
</div>
</div>
<p>Fascinating. The D-optimal experiment is close to a square wave that fluctuates between maximum power and off. The square wave transitions from full power to off when the predicted sensor temperature reaches ~85 °C. Likewise, the heater turns back on when the sensor cools to ~60 °C. Then the following cycle allows the sensor to return to 40 °C. This experiment captures two cooling cycles and almost three full heating events.</p>
<p>Finally, let’s analyze the predicted FIM of the new optimized experiment plus the existing sine wave experiment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_summary</span><span class="p">(</span><span class="n">TC_Lab_DoE_D</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;FIM&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>======Results Summary======
Four design criteria log10() value:
A-optimality: 6.2351532377339645
D-optimality: 14.560571732277468
E-optimality: -0.9421764209340528
Modified E-optimality: 7.117191376655517

FIM:
 [[1484716.4838525357, 8385.314034614812, -122009.42885862324, 3986.746701916149], [8385.314034614812, 12166.088352713867, 35185.570312046, 12908.796397561779], [-122009.42885862324, 35185.570312046, 207816.22848146953, 40882.82329357158], [3986.746701916149, 12908.796397561779, 40882.82329357158, 13815.84523653591]]

eigenvalues:
 [1.49628718e+06 2.12204805e+05 1.00225443e+04 1.14241416e-01]

eigenvectors:
 [[-9.95549809e-01 -8.97389772e-02  2.87661991e-02  9.14210614e-06]
 [-3.39311263e-03 -1.85444140e-01 -6.95720553e-01 -6.93953795e-01]
 [ 9.41756501e-02 -9.55575881e-01  2.78256029e-01 -2.40679407e-02]
 [-1.09708330e-04 -2.10789286e-01 -6.61603356e-01  7.19617165e-01]]
</pre></div>
</div>
</div>
</div>
<p>Success. The FIM of the new optimized experiment and the existing sine wave experiment is not rank deficient! We see from the eigendecomposition we still have the least information about parameter <span class="math notranslate nohighlight">\(C_p^S\)</span>. However, these results suggest we can uniquely estimate all four parameters using just two experiments.</p>
</section>
<section id="optimize-next-experiment-a-optimality">
<h2>Optimize next experiment (A-optimality)<a class="headerlink" href="#optimize-next-experiment-a-optimality" title="Permalink to this heading">#</a></h2>
<p>Next, we will consider A-optimality.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create experiment object for design of experiments</span>
<span class="n">doe_experiment</span> <span class="o">=</span> <span class="n">TC_Lab_experiment</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">tc_data</span><span class="p">,</span> <span class="n">theta_initial</span><span class="o">=</span><span class="n">theta_values</span><span class="p">,</span> <span class="n">number_of_states</span><span class="o">=</span><span class="n">number_tclab_states</span><span class="p">)</span>

<span class="c1"># Create the design of experiments object using our experiment instance from above</span>
<span class="n">TC_Lab_DoE_A</span> <span class="o">=</span> <span class="n">DesignOfExperiments</span><span class="p">(</span><span class="n">experiment</span><span class="o">=</span><span class="n">doe_experiment</span><span class="p">,</span> 
                                 <span class="n">step</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
                                 <span class="n">scale_constant_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                 <span class="n">scale_nominal_param_value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                 <span class="n">objective_option</span><span class="o">=</span><span class="s2">&quot;trace&quot;</span><span class="p">,</span>  <span class="c1"># Now we specify a type of objective, A-opt = &quot;trace&quot;</span>
                                 <span class="n">prior_FIM</span><span class="o">=</span><span class="n">FIM</span><span class="p">,</span>  <span class="c1"># We use the prior information from the same existing experiment as in the D-optimal case!</span>
                                 <span class="n">tee</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>

<span class="n">TC_Lab_DoE_A</span><span class="o">.</span><span class="n">run_doe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1800
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      602
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      300
                     variables with only upper bounds:        0
Total number of equality constraints.................:      602
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 3.76e-01 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1  0.0000000e+00 3.55e-15 1.04e-02  -1.0 2.21e+00    -  9.11e-01 1.00e+00h  1

Number of Iterations....: 1

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   0.0000000000000000e+00    0.0000000000000000e+00
Constraint violation....:   3.5527136788005009e-15    3.5527136788005009e-15
Complementarity.........:   0.0000000000000000e+00    0.0000000000000000e+00
Overall NLP error.......:   3.5527136788005009e-15    3.5527136788005009e-15


Number of objective function evaluations             = 2
Number of objective gradient evaluations             = 2
Number of equality constraint evaluations            = 2
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 2
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 1
Total CPU secs in IPOPT (w/o function evaluations)   =      0.002
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1951
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      753
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      451
                     variables with only upper bounds:        0
Total number of equality constraints.................:      602
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 3.41e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (18093)
   1  0.0000000e+00 3.55e-15 3.98e-04  -1.0 3.89e-01    -  9.78e-01 1.00e+00f  1
   2  0.0000000e+00 3.55e-15 1.33e-03  -1.0 9.68e+00    -  9.40e-01 1.00e+00f  1
   3  0.0000000e+00 3.55e-15 5.56e-04  -1.7 3.29e+01    -  8.81e-01 1.00e+00f  1
   4  0.0000000e+00 3.55e-15 6.40e-18  -2.5 3.16e+00    -  1.00e+00 1.00e+00f  1
   5  0.0000000e+00 3.55e-15 5.32e-19  -3.8 3.68e+00    -  1.00e+00 1.00e+00f  1
   6  0.0000000e+00 3.55e-15 7.31e-21  -5.7 4.29e-01    -  1.00e+00 1.00e+00f  1
   7  0.0000000e+00 3.76e-15 3.85e-22  -8.6 6.23e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 7

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   3.8463898483715787e-22    3.8463898483715787e-22
Constraint violation....:   3.7608804959177178e-15    3.7608804959177178e-15
Complementarity.........:   5.3526636694796017e-09    5.3526636694796017e-09
Overall NLP error.......:   5.3526636694796017e-09    5.3526636694796017e-09


Number of objective function evaluations             = 8
Number of objective gradient evaluations             = 8
Number of equality constraint evaluations            = 8
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 8
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 7
Total CPU secs in IPOPT (w/o function evaluations)   =      0.009
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1951
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      753
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      451
                     variables with only upper bounds:        0
Total number of equality constraints.................:      602
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 3.41e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (18093)
   1  0.0000000e+00 3.55e-15 6.51e-04  -1.0 5.04e-01    -  9.72e-01 1.00e+00f  1
   2  0.0000000e+00 3.55e-15 6.27e-04  -1.0 9.47e+00    -  9.75e-01 1.00e+00f  1
   3  0.0000000e+00 3.55e-15 9.84e-05  -1.7 6.36e+00    -  9.69e-01 1.00e+00f  1
   4  0.0000000e+00 3.55e-15 3.43e-05  -2.5 1.28e+01    -  9.59e-01 1.00e+00f  1
   5  0.0000000e+00 3.55e-15 2.57e-19  -3.8 1.40e+00    -  1.00e+00 1.00e+00f  1
   6  0.0000000e+00 3.55e-15 2.83e-20  -5.7 5.96e-01    -  1.00e+00 1.00e+00f  1
   7  0.0000000e+00 3.55e-15 1.41e-22  -8.6 4.56e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 7

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   1.4082749928715296e-22    1.4082749928715296e-22
Constraint violation....:   3.5527136788005009e-15    3.5527136788005009e-15
Complementarity.........:   4.7026222762342791e-09    4.7026222762342791e-09
Overall NLP error.......:   4.7026222762342791e-09    4.7026222762342791e-09


Number of objective function evaluations             = 8
Number of objective gradient evaluations             = 8
Number of equality constraint evaluations            = 8
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 8
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 7
Total CPU secs in IPOPT (w/o function evaluations)   =      0.010
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1951
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      753
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      451
                     variables with only upper bounds:        0
Total number of equality constraints.................:      602
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 3.43e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (18093)
   1  0.0000000e+00 3.55e-15 4.62e-05  -1.0 1.03e-01    -  9.89e-01 1.00e+00f  1
   2  0.0000000e+00 3.65e-15 2.43e-17  -1.0 9.93e+00    -  1.00e+00 1.00e+00f  1
   3  0.0000000e+00 5.33e-15 1.82e-17  -2.5 2.66e+00    -  1.00e+00 1.00e+00f  1
   4  0.0000000e+00 3.55e-15 1.74e-08  -3.8 2.04e+00    -  1.00e+00 1.00e+00f  1
   5  0.0000000e+00 3.55e-15 1.94e-08  -5.7 1.85e+00    -  9.96e-01 1.00e+00f  1
   6  0.0000000e+00 3.55e-15 4.73e-14  -8.6 3.85e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 6

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   4.7326499001393032e-14    4.7326499001393032e-14
Constraint violation....:   3.5527136788005009e-15    3.5527136788005009e-15
Complementarity.........:   4.8319883555020095e-09    4.8319883555020095e-09
Overall NLP error.......:   4.8319883555020095e-09    4.8319883555020095e-09


Number of objective function evaluations             = 7
Number of objective gradient evaluations             = 7
Number of equality constraint evaluations            = 7
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 7
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 6
Total CPU secs in IPOPT (w/o function evaluations)   =      0.003
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1951
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      753
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      451
                     variables with only upper bounds:        0
Total number of equality constraints.................:      602
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 3.43e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (18093)
   1  0.0000000e+00 3.55e-15 3.50e-05  -1.0 1.00e-01    -  9.90e-01 1.00e+00f  1
   2  0.0000000e+00 3.80e-15 2.43e-17  -1.0 9.94e+00    -  1.00e+00 1.00e+00f  1
   3  0.0000000e+00 3.55e-15 1.77e-17  -2.5 3.12e+00    -  1.00e+00 1.00e+00f  1
   4  0.0000000e+00 3.55e-15 2.57e-07  -3.8 1.95e+00    -  9.97e-01 1.00e+00f  1
   5  0.0000000e+00 3.77e-15 1.36e-08  -5.7 1.65e+00    -  9.97e-01 1.00e+00f  1
   6  0.0000000e+00 3.55e-15 1.44e-12  -8.6 3.95e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 6

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   1.4351761207895442e-12    1.4351761207895442e-12
Constraint violation....:   3.5527136788005009e-15    3.5527136788005009e-15
Complementarity.........:   4.9764826151987226e-09    4.9764826151987226e-09
Overall NLP error.......:   4.9764826151987226e-09    4.9764826151987226e-09


Number of objective function evaluations             = 7
Number of objective gradient evaluations             = 7
Number of equality constraint evaluations            = 7
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 7
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 6
Total CPU secs in IPOPT (w/o function evaluations)   =      0.006
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1951
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      753
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      451
                     variables with only upper bounds:        0
Total number of equality constraints.................:      602
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 3.69e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (18093)
   1  0.0000000e+00 3.55e-15 2.03e-04  -1.0 2.05e-01    -  9.83e-01 1.00e+00f  1
   2  0.0000000e+00 3.55e-15 8.33e-17  -1.0 9.63e+00    -  1.00e+00 1.00e+00f  1
   3  0.0000000e+00 3.55e-15 1.37e-17  -1.7 1.29e+01    -  1.00e+00 1.00e+00f  1
   4  0.0000000e+00 3.55e-15 3.52e-18  -2.5 8.06e+00    -  1.00e+00 1.00e+00f  1
   5  0.0000000e+00 3.55e-15 4.40e-19  -3.8 2.21e+00    -  1.00e+00 1.00e+00f  1
   6  0.0000000e+00 3.55e-15 1.91e-20  -5.7 4.75e-01    -  1.00e+00 1.00e+00f  1
   7  0.0000000e+00 3.55e-15 2.77e-22  -8.6 4.85e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 7

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   2.7710550520526427e-22    2.7710550520526427e-22
Constraint violation....:   3.5527136788005009e-15    3.5527136788005009e-15
Complementarity.........:   4.8792798895046795e-09    4.8792798895046795e-09
Overall NLP error.......:   4.8792798895046795e-09    4.8792798895046795e-09


Number of objective function evaluations             = 8
Number of objective gradient evaluations             = 8
Number of equality constraint evaluations            = 8
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 8
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 7
Total CPU secs in IPOPT (w/o function evaluations)   =      0.008
Total CPU secs in NLP function evaluations           =      0.001

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1951
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      753
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      451
                     variables with only upper bounds:        0
Total number of equality constraints.................:      602
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 3.69e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (18093)
   1  0.0000000e+00 3.55e-15 1.71e-04  -1.0 2.41e-01    -  9.85e-01 1.00e+00f  1
   2  0.0000000e+00 3.55e-15 5.53e-04  -1.0 5.81e+00    -  9.54e-01 1.00e+00f  1
   3  0.0000000e+00 3.55e-15 4.71e-04  -1.7 4.04e+01    -  8.75e-01 1.00e+00f  1
   4  0.0000000e+00 3.55e-15 5.31e-18  -2.5 3.18e+00    -  1.00e+00 1.00e+00f  1
   5  0.0000000e+00 3.55e-15 5.42e-19  -3.8 3.31e+00    -  1.00e+00 1.00e+00f  1
   6  0.0000000e+00 3.55e-15 9.85e-21  -5.7 3.88e-01    -  1.00e+00 1.00e+00f  1
   7  0.0000000e+00 2.76e-15 2.34e-22  -8.6 5.49e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 7

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   2.3409211335250683e-22    2.3409211335250683e-22
Constraint violation....:   2.7616797737550769e-15    2.7616797737550769e-15
Complementarity.........:   5.1165889275871179e-09    5.1165889275871179e-09
Overall NLP error.......:   5.1165889275871179e-09    5.1165889275871179e-09


Number of objective function evaluations             = 8
Number of objective gradient evaluations             = 8
Number of equality constraint evaluations            = 8
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 8
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 7
Total CPU secs in IPOPT (w/o function evaluations)   =      0.010
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1951
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      753
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      451
                     variables with only upper bounds:        0
Total number of equality constraints.................:      602
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 3.43e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (18093)
   1  0.0000000e+00 3.55e-15 4.84e-05  -1.0 1.05e-01    -  9.89e-01 1.00e+00f  1
   2  0.0000000e+00 3.55e-15 2.08e-17  -1.0 9.92e+00    -  1.00e+00 1.00e+00f  1
   3  0.0000000e+00 3.55e-15 1.47e-17  -2.5 2.55e+00    -  1.00e+00 1.00e+00f  1
   4  0.0000000e+00 3.55e-15 1.76e-19  -3.8 2.09e+00    -  1.00e+00 1.00e+00f  1
   5  0.0000000e+00 3.55e-15 1.74e-08  -5.7 1.71e+00    -  9.96e-01 1.00e+00f  1
   6  0.0000000e+00 3.55e-15 2.26e-13  -8.6 3.95e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 6

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   2.2587528186040976e-13    2.2587528186040976e-13
Constraint violation....:   3.5527136788005009e-15    3.5527136788005009e-15
Complementarity.........:   4.8736431340332237e-09    4.8736431340332237e-09
Overall NLP error.......:   4.8736431340332237e-09    4.8736431340332237e-09


Number of objective function evaluations             = 7
Number of objective gradient evaluations             = 7
Number of equality constraint evaluations            = 7
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 7
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 6
Total CPU secs in IPOPT (w/o function evaluations)   =      0.016
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:     1951
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      753
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      451
                     variables with only upper bounds:        0
Total number of equality constraints.................:      602
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 3.43e-03 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (18093)
   1  0.0000000e+00 3.55e-15 3.51e-05  -1.0 1.00e-01    -  9.90e-01 1.00e+00f  1
   2  0.0000000e+00 3.55e-15 2.08e-17  -1.0 9.93e+00    -  1.00e+00 1.00e+00f  1
   3  0.0000000e+00 3.55e-15 1.31e-17  -2.5 3.29e+00    -  1.00e+00 1.00e+00f  1
   4  0.0000000e+00 3.55e-15 3.09e-07  -3.8 1.98e+00    -  9.96e-01 1.00e+00f  1
   5  0.0000000e+00 3.55e-15 1.30e-08  -5.7 1.60e+00    -  9.97e-01 1.00e+00f  1
   6  0.0000000e+00 3.55e-15 1.66e-12  -8.6 3.95e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 6

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   1.6640804565696806e-12    1.6640804565696806e-12
Constraint violation....:   3.5527136788005009e-15    3.5527136788005009e-15
Complementarity.........:   4.9986864279830130e-09    4.9986864279830130e-09
Overall NLP error.......:   4.9986864279830130e-09    4.9986864279830130e-09


Number of objective function evaluations             = 7
Number of objective gradient evaluations             = 7
Number of equality constraint evaluations            = 7
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 7
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 6
Total CPU secs in IPOPT (w/o function evaluations)   =      0.008
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:    20744
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:     1510

Total number of variables............................:     6487
                     variables with only lower bounds:        0
                variables with lower and upper bounds:     3457
                     variables with only upper bounds:        0
Total number of equality constraints.................:     6487
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 5.54e+01 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (330773)
   1  0.0000000e+00 4.31e+05 9.28e-01  -1.0 3.58e+01    -  4.23e-01 1.00e+00h  1
   2  0.0000000e+00 1.16e-10 5.50e-03  -1.0 4.31e+05    -  9.92e-01 1.00e+00h  1

Number of Iterations....: 2

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   0.0000000000000000e+00    0.0000000000000000e+00
Constraint violation....:   1.1641532182693481e-10    1.1641532182693481e-10
Complementarity.........:   0.0000000000000000e+00    0.0000000000000000e+00
Overall NLP error.......:   1.1641532182693481e-10    1.1641532182693481e-10


Number of objective function evaluations             = 3
Number of objective gradient evaluations             = 3
Number of equality constraint evaluations            = 3
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 3
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 2
Total CPU secs in IPOPT (w/o function evaluations)   =      0.099
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
Ipopt 3.13.2: linear_solver=ma57
halt_on_ampl_error=yes
max_iter=3000


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt

This version of Ipopt was compiled from source code available at
    https://github.com/IDAES/Ipopt as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See https://github.com/IDAES/idaes-pse.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See http://www.hsl.rl.ac.uk.
******************************************************************************

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:    21957
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:     1511

Reallocating memory for MA57: lfact (395598)
Total number of variables............................:     6639
                     variables with only lower bounds:        1
                variables with lower and upper bounds:     3608
                     variables with only upper bounds:        0
Total number of equality constraints.................:     6488
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0 -5.7732318e+00 4.78e+05 1.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1 -5.8183289e+00 8.46e+04 1.38e+01  -1.0 3.78e+05    -  4.56e-01 1.00e+00h  1
   2 -5.8492322e+00 2.91e+03 1.72e+00  -1.0 4.85e+04    -  8.36e-01 1.00e+00h  1
   3 -5.8514044e+00 1.96e+00 3.18e-02  -1.0 3.54e+03    -  9.85e-01 1.00e+00h  1
   4 -5.8761990e+00 5.55e+03 8.36e-03  -1.0 4.42e+04    -  9.35e-01 1.00e+00f  1
   5 -5.9356123e+00 1.88e+04 1.88e-03  -1.0 1.10e+05    -  8.84e-01 1.00e+00h  1
   6 -5.9517203e+00 7.35e+01 3.02e-06  -1.0 3.26e+04    -  1.00e+00 1.00e+00h  1
   7 -5.9516866e+00 2.35e-02 1.00e-06  -1.0 7.72e+01    -  1.00e+00 1.00e+00h  1
   8 -5.9519543e+00 2.37e-01 1.79e-07  -2.5 5.52e+02    -  1.00e+00 1.00e+00h  1
   9 -5.9611275e+00 2.85e+02 1.07e-06  -2.5 1.91e+04    -  1.00e+00 1.00e+00h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  10 -5.9613477e+00 3.09e-02 3.01e-08  -2.5 4.64e+02    -  1.00e+00 1.00e+00h  1
  11 -5.9708350e+00 2.98e+02 3.56e-07  -3.8 2.02e+04    -  1.00e+00 1.00e+00h  1
  12 -6.1437890e+00 7.30e+04 1.96e-04  -3.8 4.48e+05    -  1.00e+00 1.00e+00H  1
  13 -6.1192787e+00 2.92e+03 1.29e-04  -3.8 7.64e+04    -  1.00e+00 1.00e+00h  1
  14 -6.1281208e+00 1.99e+03 2.24e-06  -3.8 2.71e+04    -  1.00e+00 1.00e+00h  1
  15 -6.1248634e+00 1.29e+02 5.06e-07  -3.8 1.00e+04    -  1.00e+00 1.00e+00h  1
  16 -6.1250529e+00 1.64e-01 3.00e-08  -3.8 5.82e+02    -  1.00e+00 1.00e+00h  1
  17 -6.1250389e+00 9.88e-04 1.50e-09  -3.8 4.29e+01    -  1.00e+00 1.00e+00h  1
  18 -6.2287130e+00 3.96e+04 7.35e-06  -5.7 3.60e+05    -  7.91e-01 1.00e+00f  1
  19 -6.3103098e+00 2.78e+04 3.99e-06  -5.7 4.06e+05    -  6.59e-01 8.62e-01h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  20 -6.3248855e+00 1.04e+04 7.38e-06  -5.7 1.08e+05    -  6.23e-01 6.46e-01h  1
  21 -6.3284025e+00 5.17e+03 6.84e-06  -5.7 3.36e+04    -  6.00e-01 5.11e-01h  1
  22 -6.3284024e+00 4.21e+03 9.12e-03  -5.7 1.81e+01  -4.0 3.08e-04 1.86e-01h  1
  23 -6.3294531e+00 1.06e+03 2.32e-03  -5.7 6.90e+03    -  1.00e+00 7.48e-01h  1
  24 -6.3301892e+00 3.32e+02 7.15e-04  -5.7 5.25e+03    -  1.00e+00 6.90e-01h  1
  25 -6.3305978e+00 2.69e+01 5.48e-05  -5.7 2.18e+03    -  1.00e+00 9.22e-01h  1
  26 -6.3309354e+00 6.69e+01 1.56e-05  -5.7 4.30e+03    -  1.00e+00 7.12e-01h  1
  27 -6.3310646e+00 8.46e+01 3.80e-06  -5.7 3.45e+03    -  1.00e+00 9.23e-01h  1
  28 -6.3311316e+00 7.84e+01 2.86e-07  -5.7 2.91e+03    -  1.00e+00 1.00e+00h  1
  29 -6.3311486e+00 4.37e+00 1.70e-08  -5.7 5.25e+02    -  1.00e+00 1.00e+00h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  30 -6.3311476e+00 5.40e-01 2.98e-09  -5.7 2.10e+02    -  1.00e+00 1.00e+00h  1
  31 -6.3311472e+00 6.84e-03 1.84e-11  -5.7 2.54e+01    -  1.00e+00 1.00e+00h  1
  32 -6.3311472e+00 2.83e-08 2.52e-08  -5.7 7.56e-04  -4.5 1.00e+00 1.00e+00h  1
  33 -6.3317543e+00 2.49e+01 1.64e-05  -8.6 1.04e+04    -  4.92e-01 2.90e-01f  1
  34 -6.3320613e+00 8.32e+01 1.10e-05  -8.6 1.08e+04    -  1.96e-01 2.47e-01h  1
  35 -6.3322159e+00 7.29e+01 1.09e-05  -8.6 3.95e+03    -  3.10e-01 2.00e-01h  1
  36 -6.3322789e+00 6.62e+01 3.31e-05  -8.6 3.34e+03    -  3.02e-01 1.19e-01h  1
  37 -6.3324274e+00 5.97e+01 2.28e-05  -8.6 3.07e+03    -  3.25e-01 3.19e-01h  1
  38 -6.3325405e+00 3.85e+01 1.60e-05  -8.6 1.44e+03    -  5.61e-01 3.90e-01h  1
  39 -6.3326164e+00 2.16e+01 8.84e-06  -8.6 8.18e+02    -  5.19e-01 4.60e-01h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  40 -6.3326351e+00 1.69e+01 7.81e-06  -8.6 4.23e+02    -  5.87e-01 2.18e-01h  1
  41 -6.3326729e+00 7.38e+00 8.30e-06  -8.6 3.28e+02    -  1.00e+00 5.71e-01h  1
  42 -6.3326973e+00 8.31e-01 2.26e-06  -8.6 1.37e+02    -  1.00e+00 8.88e-01h  1
  43 -6.3327003e+00 3.87e-05 3.36e-13  -8.6 1.48e+01    -  1.00e+00 1.00e+00h  1
Reallocating memory for MA57: lfact (422080)
  44 -6.3327003e+00 1.23e-08 2.51e-14  -8.6 4.24e-02    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 44

                                   (scaled)                 (unscaled)
Objective...............:  -6.3327003245850708e+00   -6.3327003245850708e+00
Dual infeasibility......:   2.5059035674162971e-14    2.5059035674162971e-14
Constraint violation....:   9.1604306362569332e-09    1.2289092410355805e-08
Complementarity.........:   2.7196815779234200e-09    2.7196815779234200e-09
Overall NLP error.......:   9.1604306362569332e-09    1.2289092410355805e-08


Number of objective function evaluations             = 46
Number of objective gradient evaluations             = 45
Number of equality constraint evaluations            = 46
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 45
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 44
Total CPU secs in IPOPT (w/o function evaluations)   =      1.596
Total CPU secs in NLP function evaluations           =      0.005

EXIT: Optimal Solution Found.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dopt_pyomo_doe_results</span> <span class="o">=</span> <span class="n">extract_plot_results</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">TC_Lab_DoE_A</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">scenario_blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/136c7ff73739aa5a920160097556daf445e7a92d660020d57d2045b9aaf8142b.png" src="../_images/136c7ff73739aa5a920160097556daf445e7a92d660020d57d2045b9aaf8142b.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
Ua = 0.0421 Watts/degC
Ub = 0.0094 Watts/degC
CpH = 6.0274 Joules/degC
CpS = 0.1714 Joules/degC
 
</pre></div>
</div>
</div>
</div>
<p>Interestingly, we get a different optimal experiment. However, square-tooth like structure appears to emulate the first cycle in the D-optimal experiment, however achieving a higher temperature appears to be the best experiment for the A-optimal criteria.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_summary</span><span class="p">(</span><span class="n">TC_Lab_DoE_A</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;FIM&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>======Results Summary======
Four design criteria log10() value:
A-optimality: 6.332700324585071
D-optimality: 14.221895379167925
E-optimality: -1.035091770165665
Modified E-optimality: 7.3342634189119815

FIM:
 [[1955865.1928081303, -10256.668510071942, -252788.48744997822, -18301.258965837907], [-10256.668510071942, 8250.475377585391, 27927.87862216795, 8884.520772699641], [-252788.48744997822, 27927.87862216795, 177519.01981971957, 32875.957483123544], [-18301.258965837907, 8884.520772699641, 32875.957483123544, 9662.079129546986]]

eigenvalues:
 [1.99146028e+06 1.53941730e+05 5.89466513e+03 9.22376500e-02]

eigenvectors:
 [[-9.90295022e-01  1.36479979e-01 -2.62484625e-02 -5.56588466e-05]
 [ 7.12084874e-03  1.85358482e-01  6.96595323e-01 -6.93070330e-01]
 [ 1.38323769e-01  9.50087656e-01 -2.78570003e-01 -2.44690500e-02]
 [ 1.14716207e-02  2.10591771e-01  6.60654772e-01  7.20454565e-01]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="sensitivity-analysis">
<h2>Sensitivity Analysis<a class="headerlink" href="#sensitivity-analysis" title="Permalink to this heading">#</a></h2>
<p>The eigendecomposition of the FIM above shows we have the least information (and thus greatest uncertainty) about parameter <span class="math notranslate nohighlight">\(C_p^S\)</span>. In fact, notice that <span class="math notranslate nohighlight">\(C_p^S\)</span> goes to its bound in our earlier <a class="reference internal" href="parmest.html"><span class="doc std std-doc">parameter estimation</span></a> analysis.</p>
<p>This uncertainty motivates performing a sensivitiy analysis of the optimal experiment design to perturbations in <span class="math notranslate nohighlight">\(C_p^S\)</span>. The code below focuses on A-optimality because it is computational less expensive, but and can easily adapted to D-optimality by changing the <code class="docutils literal notranslate"><span class="pre">objective_option</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">CpS_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">a_opt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">CpS_values</span><span class="p">)))</span>
<span class="n">u_solutions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">CpS_values</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">tc_data</span><span class="o">.</span><span class="n">time</span><span class="p">)))</span>
<span class="n">Ts_solutions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">CpS_values</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">tc_data</span><span class="o">.</span><span class="n">time</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">CpS_values</span><span class="p">):</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">********************</span><span class="se">\n</span><span class="s2">CpS = &quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="s2">&quot; J/°C&quot;</span><span class="p">)</span>

    <span class="n">theta_values_new</span> <span class="o">=</span> <span class="n">theta_values</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">theta_values_new</span><span class="p">[</span><span class="s1">&#39;inv_CpS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">v</span>

    <span class="c1"># Create experiment object for design of experiments</span>
    <span class="n">doe_experiment</span> <span class="o">=</span> <span class="n">TC_Lab_experiment</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">tc_data</span><span class="p">,</span> <span class="n">theta_initial</span><span class="o">=</span><span class="n">theta_values_new</span><span class="p">,</span> <span class="n">number_of_states</span><span class="o">=</span><span class="n">number_tclab_states</span><span class="p">)</span>
    
    <span class="c1"># Create the design of experiments object using our experiment instance from above</span>
    <span class="n">TC_Lab_DoE</span> <span class="o">=</span> <span class="n">DesignOfExperiments</span><span class="p">(</span><span class="n">experiment</span><span class="o">=</span><span class="n">doe_experiment</span><span class="p">,</span> 
                                     <span class="n">step</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
                                     <span class="n">scale_constant_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                     <span class="n">scale_nominal_param_value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                     <span class="n">tee</span><span class="o">=</span><span class="kc">False</span><span class="p">,)</span>

    <span class="n">FIM_new</span> <span class="o">=</span> <span class="n">TC_Lab_DoE</span><span class="o">.</span><span class="n">compute_FIM</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sequential&#39;</span><span class="p">)</span>

    <span class="c1"># Create a new DoE object</span>
    <span class="n">TC_Lab_DoE</span> <span class="o">=</span> <span class="n">DesignOfExperiments</span><span class="p">(</span><span class="n">experiment</span><span class="o">=</span><span class="n">doe_experiment</span><span class="p">,</span> 
                                     <span class="n">step</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
                                     <span class="n">scale_constant_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                     <span class="n">scale_nominal_param_value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">objective_option</span><span class="o">=</span><span class="s2">&quot;trace&quot;</span><span class="p">,</span>  <span class="c1"># We specify a type of objective, A-opt = &quot;trace&quot;</span>
                                     <span class="n">prior_FIM</span><span class="o">=</span><span class="n">FIM</span><span class="p">,</span>  <span class="c1"># We use the prior information from the original experiment</span>
                                     <span class="n">tee</span><span class="o">=</span><span class="kc">False</span><span class="p">,)</span>
    
    <span class="n">TC_Lab_DoE</span><span class="o">.</span><span class="n">run_doe</span><span class="p">()</span>

    
    <span class="n">pyomo_results</span> <span class="o">=</span> <span class="n">extract_results</span><span class="p">(</span><span class="n">TC_Lab_DoE</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">scenario_blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">results_summary</span><span class="p">(</span><span class="n">TC_Lab_DoE</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;FIM&#39;</span><span class="p">])</span>

    <span class="n">a_opt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">TC_Lab_DoE</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;FIM&#39;</span><span class="p">]))</span>
    <span class="n">u_solutions</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pyomo_results</span><span class="o">.</span><span class="n">u1</span>
    <span class="n">Ts_solutions</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pyomo_results</span><span class="o">.</span><span class="n">TS1_data</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;********************</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>********************
CpS =  0.01  J/°C
======Results Summary======
Four design criteria log10() value:
A-optimality: 6.345620766498505
D-optimality: 16.557236420353764
E-optimality: 1.1762641874433832
Modified E-optimality: 5.1369934458645155

FIM:
 [[2022826.6843716432, 829.8956823446237, -253458.792748775, -1844.3200988452588], [829.8956823446237, 5018.395139330466, 13267.86931681891, 5253.887159678284], [-253458.792748775, 13267.86931681891, 182871.0061206644, 15273.342611570326], [-1844.3200988452588, 5253.887159678284, 15273.342611570326, 5544.211892849836]]

eigenvalues:
 [2.05711056e+06 1.51416060e+05 7.71867330e+03 1.50059739e+01]

eigenvectors:
 [[-9.90975205e-01 -1.32948451e-01  1.71120584e-02  1.73845853e-04]
 [ 4.70656783e-04 -9.34233205e-02 -6.91297021e-01 -7.16505611e-01]
 [ 1.34031153e-01 -9.81169740e-01  1.38943069e-01 -6.03444276e-03]
 [ 1.88989842e-03 -1.04416157e-01 -7.08879701e-01  6.97555205e-01]]
********************


********************
CpS =  0.05  J/°C
======Results Summary======
Four design criteria log10() value:
A-optimality: 6.342325011779826
D-optimality: 16.321525241559577
E-optimality: 1.0002023526296024
Modified E-optimality: 5.309645954586698

FIM:
 [[2006472.394538007, -1467.0401482268803, -253316.132823798, -5414.614507492659], [-1467.0401482268803, 5331.469940705959, 16889.27482496716, 5601.521979178391], [-253316.132823798, 16889.27482496716, 181767.3677006974, 19662.58659537228], [-5414.614507492659, 5601.521979178391, 19662.58659537228, 5934.062631847605]]

eigenvalues:
 [2.04102492e+06 1.51702014e+05 6.76835666e+03 1.00046604e+01]

eigenvectors:
 [[-9.90828557e-01  1.33692536e-01 -1.96231275e-02  9.89308405e-05]
 [ 1.84539923e-03  1.16226648e-01  6.95096845e-01 -7.09456367e-01]
 [ 1.35054779e-01  9.75416487e-01 -1.73837433e-01 -1.01700856e-02]
 [ 3.94617173e-03  1.31073830e-01  6.97306143e-01  7.04675970e-01]]
********************


********************
CpS =  0.1  J/°C
======Results Summary======
Four design criteria log10() value:
A-optimality: 6.338305077462897
D-optimality: 15.91622580578106
E-optimality: 0.6410420755686448
Modified E-optimality: 5.664468827976248

FIM:
 [[1985809.1550228556, -4753.045405788305, -253116.64035824887, -10348.70079375541], [-4753.045405788305, 6221.3496716527125, 21476.075843530678, 6596.462411900629], [-253116.64035824887, 21476.075843530678, 180152.17262518042, 25177.03340049613], [-10348.70079375541, 6596.462411900629, 25177.03340049613, 7057.401320143186]]

eigenvalues:
 [2.02074216e+06 1.52373364e+05 6.12017401e+03 4.37564495e+00]

eigenvectors:
 [[-9.90627510e-01  1.34711035e-01 -2.25847797e-02 -1.64016116e-05]
 [ 3.81334342e-03  1.45034949e-01  6.98333196e-01 -7.00914452e-01]
 [ 1.36368025e-01  9.66326089e-01 -2.17618427e-01 -1.61205103e-02]
 [ 6.80851583e-03  1.64413167e-01  6.81515146e-01  7.13063153e-01]]
********************


********************
CpS =  0.5  J/°C
======Results Summary======
Four design criteria log10() value:
A-optimality: 6.308227354867407
D-optimality: 17.2140928274729
E-optimality: 1.743297276186294
Modified E-optimality: 4.5254408898399205

FIM:
 [[1814818.2397931218, -46227.91439323254, -250460.46722158237, -66459.37899154567], [-46227.91439323254, 23869.06890217848, 52737.913904675544, 26917.54673919637], [-250460.46722158237, 52737.913904675544, 164083.29380926758, 62175.163641595085], [-66459.37899154567, 26917.54673919637, 62175.163641595085, 30650.63384980441]]

eigenvalues:
 [1.85668473e+06 1.67154502e+05 9.52663022e+03 5.53729009e+01]

eigenvectors:
 [[-0.98758136  0.1537699  -0.03203633  0.00339956]
 [ 0.02979323  0.33411043  0.60897714 -0.71876938]
 [ 0.14858665  0.84961147 -0.50532261 -0.02704482]
 [ 0.04144194  0.37800184  0.61054859  0.69471404]]
********************


********************
CpS =  1.0  J/°C
======Results Summary======
Four design criteria log10() value:
A-optimality: 6.2736109217669735
D-optimality: 17.87184745410738
E-optimality: 2.0770029315286553
Modified E-optimality: 4.146408066672371

FIM:
 [[1604350.725326083, -117739.53034468756, -242878.6550187617, -155742.8293981735], [-117739.53034468756, 53729.0818745208, 74760.56129881516, 62446.54001365692], [-242878.6550187617, 74760.56129881516, 146437.60208523984, 88110.12839713677], [-155742.8293981735, 62446.54001365692, 88110.12839713677, 73116.50833673016]]

eigenvalues:
 [1.67267281e+06 1.84654633e+05 2.01870712e+04 1.19399616e+02]

eigenvectors:
 [[ 0.97679606 -0.21323534  0.01776713  0.00919096]
 [-0.08283596 -0.45140663 -0.47514835 -0.75073584]
 [-0.16570503 -0.70124636  0.69339326  0.00107751]
 [-0.10746861 -0.50893642 -0.54140942  0.6605377 ]]
********************
</pre></div>
</div>
</div>
</div>
<p>Now let’s visualize how the <em>A-optimality objective</em> changes as a function of <span class="math notranslate nohighlight">\(C_p^S\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">CpS_values</span><span class="p">,</span> <span class="n">a_opt</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$C_p^S$ ( J / °C )&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;log$_</span><span class="si">{10}</span><span class="s1">$( trace(FIM) )&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/35943538438adfc55759824dce9d69576ae4dd7f65c2a74c9fdcd4984fa9ccf5.png" src="../_images/35943538438adfc55759824dce9d69576ae4dd7f65c2a74c9fdcd4984fa9ccf5.png" />
</div>
</div>
<p>We see the objective changes insignificantly as we vary <span class="math notranslate nohighlight">\(C_p^S\)</span>. What about the optimal solution?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">CpS_values</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tc_data</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">u_solutions</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$C_p^S$ = </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Heater Power (%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/94abc706f016a0945d4dbac48ac14a75b1668235672163bba0dad2f846729e20.png" src="../_images/94abc706f016a0945d4dbac48ac14a75b1668235672163bba0dad2f846729e20.png" />
</div>
</div>
<p>Interesting, the A-optimal next experiment does change on the assumed value of <span class="math notranslate nohighlight">\(C_p^S\)</span>. For small values of <span class="math notranslate nohighlight">\(C_p^S\)</span>, the optimal solutions are similar: start around <span class="math notranslate nohighlight">\(u_1 = 100\)</span>% and then decreases as the experiment progresses. As <span class="math notranslate nohighlight">\(C_p^S\)</span> increases, the length of time spent at 100% power increases.</p>
<p>Let’s also look at the optimal sensor temperature profile:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">CpS_values</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tc_data</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">Ts_solutions</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$C_p^S$ = </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Sensor Temperature (°C)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f8d3fe0989caa5f4b490dc63c584760540f8525a20183a9e69d919960f7aa242.png" src="../_images/f8d3fe0989caa5f4b490dc63c584760540f8525a20183a9e69d919960f7aa242.png" />
</div>
</div>
<p>Now to be pragmatic. What should we do with this information? Here are some suggested next steps:</p>
<ul class="simple">
<li><p>Confirm that these optimal experiments are all very informative for all of the values of <span class="math notranslate nohighlight">\(C_p^S\)</span>. If this is the case, we can pick on, perform the experiment, and then refit our model.</p></li>
<li><p>Explore alternate formulations of MBDoE that consider uncertainty. We are working on a major overhaul of Pyomo.DoE that will make this much easier.</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="doe_exploratory_analysis.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Pyomo.DoE: Exploratory Analysis</p>
      </div>
    </a>
    <a class="right-next"
       href="doe_exercise.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Exercise: Pyomo.DoE</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-experimental-data-sine-test">Load experimental data (sine test)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-fim-at-initial-point-sine-test">Calculate FIM at initial point (sine test)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimize-next-experiment-d-optimality">Optimize next experiment (D-optimality)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimize-next-experiment-a-optimality">Optimize next experiment (A-optimality)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sensitivity-analysis">Sensitivity Analysis</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Alexander Dowling and Dan Laky
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>